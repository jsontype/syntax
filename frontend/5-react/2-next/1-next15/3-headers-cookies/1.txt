[Next 15 headers, cookies ì˜ ë¹„ë™ê¸°í™”]

1. src/actions/setCookie.ts ì‘ì„±: ì„œë²„ ì•¡ì…˜ í•¨ìˆ˜. 
  - use serverê°€ í•„ìˆ˜ì´ë‹¤.
  - ì„œë²„ ì»´í¬ë„ŒíŠ¸ëŠ” tsxë¡œ ë§Œë“¤ì§€ë§Œ, ì•¡ì…˜ í•¨ìˆ˜ëŠ” tsë¡œë§Œ ì´ë¤„ì§.
  ```
    "use server"

    import { cookies } from "next/headers"

    // tokenì— contentë¥¼ ì €ì¥í•˜ëŠ” í•¨ìˆ˜
    export async function setLoginToken(token: string, content: string) {
      const cookiesList = await cookies()

      cookiesList.set(token, content, {
        httpOnly: true, // JSì—ì„œ ì ‘ê·¼ ëª»í•˜ê²Œ (XSS ë˜ëŠ” CSRF ë°©ì§€)
        secure: true, // HTTPSì—ì„œë§Œ
        path: "/",
        maxAge: 60 * 60 * 24 * 7, // 7ì¼
      })
    }
  ```

1. src/app/components/SetCookieButton.tsx ì‘ì„±: í´ë¼ì´ì–¸íŠ¸ ì»´í¬ë„ŒíŠ¸.
  - use clientê°€ í•„ìˆ˜ì´ë‹¤.
  - onClick ì´ë²¤íŠ¸ê°€ ë°œìƒí•˜ë©´, ì„œë²„ ì•¡ì…˜ í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ì—¬ ì¿ í‚¤ë¥¼ ì„¤ì •í•˜ì§€ë§Œ, ì´ë•Œ onClickì€ Client Componentì—ì„œë§Œ ì‚¬ìš© ê°€ëŠ¥í•˜ë‹¤.
  ```
    'use client'

    import { setLoginToken } from '@/app/actions/setCookie'

    export default function SetCookieButton({ token, content }: { token: string; content: string }) {
      return (
        <button className="cursor-pointer" onClick={() => setLoginToken(token, content)}>
          ë¡œê·¸ì¸ í† í° ì„¤ì • ğŸ“
        </button>
      )
    }
  ```
  
1. src/app/ssrì€ src/app/movies/page.tsxìœ¼ë¡œ ë³€ê²½ í›„ ìˆ˜ì •: ë¬´ë¹„ í˜ì´ì§€
  - headers()ì™€ cookies()ëŠ” Next 13ê¹Œì§€ëŠ” ë™ê¸° í•¨ìˆ˜ì˜€ì§€ë§Œ, Next 15ë¶€í„°ëŠ” ë¹„ë™ê¸°ë¡œ ë°”ë€Œì—ˆë‹¤.
    ì„œë²„ ë Œë”ë§ ì‹œ í•„ìš”í•œ ì •ë³´(ì˜ˆë¥¼ ë“¤ì–´ user-agentë‚˜ ì¸ì¦ ì¿ í‚¤)ë¥¼ ì•ˆì „í•˜ê²Œ ë°›ì•„ì˜¬ ìˆ˜ ìˆë‹¤.
    ì´ë¥¼ í†µí•´ ì‚¬ìš©ì ë””ë°”ì´ìŠ¤ ì •ë³´, ì¸ì¦ ìƒíƒœ ë“±ì— ë”°ë¼ ë§ì¶¤í˜• SSR ì½˜í…ì¸ ë¥¼ êµ¬í˜„í•  ìˆ˜ ìˆë‹¤.

  import Link from 'next/link'
  import Image from 'next/image'
  import SetCookieButton from '@/app/components/SetCookieButton'
  import { headers, cookies } from 'next/headers'
  
  type Movie = {
    id: number
    title: string
    url: string
    large_cover_image: string
  }
  
  // ì„œë²„ ìš”ì²­ í•¨ìˆ˜
  async function getData(): Promise<Movie[]> {
    const response = await fetch('https://yts.mx/api/v2/list_movies.json', {
      cache: 'no-store', // 'force-cache'ëŠ” ìºì‹±ëœ ë°ì´í„° ì‚¬ìš© (SSGìš©, Next13ì—ì„œì˜ ê¸°ë³¸ê°’), 'no-store'ëŠ” í˜ì´ì§€ë¥¼ ì—´ ë•Œë§ˆë‹¤ ë§¤ë²ˆ ìƒˆë¡œ ìš”ì²­ (SSRìš©)
    })
    const data = await response.json()
    return data.data.movies
  }
  
  export default async function SSR() {
    // Next 15ì—ì„œ, headers, cookiesë¥¼ ê°€ì ¸ì˜¬ ë•Œ ë°˜ë“œì‹œ async ì„œë²„ ì»´í¬ë„ŒíŠ¸ì•ˆì—ì„œ, awaitë¥¼ ë¶™ì—¬ì•¼ í•¨. 
    // ! headers() : ì„œë²„ ìš”ì²­ í—¤ë” ì •ë³´. ì‚¬ìš©ì ìš”ì²­ì— ëŒ€í•œ ì •ë³´ë¥¼ ì•Œ ìˆ˜ ìˆìŒ.
    const headersList = await headers()
  
    // ! user-agent: ë¸Œë¼ìš°ì €/ë””ë°”ì´ìŠ¤ ì‹ë³„. ëª¨ë°”ì¼/ë°ìŠ¤í¬íƒ‘ ë¶„ê¸° ë Œë”ë§í•  ë•Œ ì‚¬ìš©.
    const headerUserAgent = headersList.get('user-agent') || 'ì•Œ ìˆ˜ ì—†ìŒ'
    // ! accept-language : ì‚¬ìš©ì ì–¸ì–´. ë‹¤êµ­ì–´(i18n) ì´ˆê¸° ë¡œì¼€ì¼ ì„¤ì • ë³¼ ë•Œ ì‚¬ìš©.
    const headerLanguage = headersList.get('accept-language') || 'ì–¸ì–´ ì •ë³´ ì—†ìŒ'
    // ! x-forwarded-for ë˜ëŠ” x-real-ip : í´ë¼ì´ì–¸íŠ¸ IP. ì‚¬ìš©ì ìœ„ì¹˜ ê¸°ë°˜ ê¸°ëŠ¥(Geo, IP ë¡œê·¸)ì„ ë§Œë“¤ ë•Œ ì‚¬ìš©.
    const headerClientIp = headersList.get('x-forwarded-for') || headersList.get('x-real-ip') || 'IP ì •ë³´ ì—†ìŒ'
    // ! authorization : í† í° ì¸ì¦ (API ì „ìš©). JWT ë“± ì¸ì¦ëœ ìš”ì²­ íŒë³„í•  ë•Œ ì‚¬ìš©.
    // const headerAuthToken = headersList.get('authorization') || 'í† í° ì—†ìŒ'
  
    console.log('headerUserAgent: ', headerUserAgent)
    console.log('headerLanguage: ', headerLanguage)
    console.log('headerClientIp: ', headerClientIp)
    // console.log('headerAuthToken: ', headerAuthToken)
  
  
  
    // ! cookies() : ì„œë²„ ì¿ í‚¤ ì •ë³´. ì¿ í‚¤ëŠ” ì›¹ì•±ì—ì„œ ë¡œì»¬ íŒŒì¼ë¡œ ê°•ì œ ì €ì¥ì‹œí‚¤ëŠ” ì •ë³´ì´ë‹¤.
    const cookiesList = await cookies()
  
    // ! myToken: ì‚¬ìš©ì ì¸ì¦ í† í°. ì‚¬ìš©ìê°€ ë¡œê·¸ì¸í•  ë•Œ, ì„œë²„ì—ì„œ ë°œê¸‰í•˜ëŠ” ê³ ìœ í•œ í† í°.
    // ì¿ í‚¤ëŠ” ë‚´ ì»´í“¨í„°ì—ì„œ ì¡°ì‘ì´ ê°€ëŠ¥í•˜ë¯€ë¡œ, ì¸ì¦ì— ì“°ëŠ” ê²ƒì€ ìœ„í—˜í•˜ë‹¤. ê·¸ë˜ì„œ, "ë³´ì•ˆìƒ ì¤‘ìš”í•˜ì§€ ì•Šì€ ê²ƒ"ì— ì‚¬ìš©. 
    // ì˜ˆë¥¼ ë“¤ë©´ ê²Œì‹œíŒìœ¼ë¡œ ì¹˜ë©´ ì¡°íšŒìˆ˜ ì œì–´ ê°™ì€ ê²ƒ.
    // -> ê²Œì‹œíŒì— ìˆëŠ” ê²Œì‹œë¬¼ ì¤‘ íŠ¹ì • ê²Œì‹œë¬¼ì„ ë´¤ëŠ”ì§€ ì•ˆë´¤ëŠ”ì§€ get(`bbs-${id}`) ê°™ì€ ì¿ í‚¤ë¥¼ ì´ìš©í•´ ì²´í¬í•´ì„œ,
    // -> ë‚´ê°€ ê²Œì‹œê¸€ì„ ì½ì€ ê²Œì‹œë¬¼ì€ ë‹¤ì‹œ ì ‘ì†í•´ë„ ì¡°íšŒìˆ˜ê°€ ì•ˆ ëŠ˜ì–´ë‚˜ê²Œ í•¨.
    const myToken = cookiesList.get('myToken')?.value || 'í† í° ì—†ìŒ'
  
    console.log('myToken:', myToken)
  
  
  
    const movies = await getData()
  
    const render = movies.map((movie) => (
      <div key={movie.id}>
        <h2>
          <Link href={movie.url}>
            {movie.title}</Link></h2>
        <p>
          <Image
            src={movie.large_cover_image}
            alt={movie.title}
            width={500}
            height={750}
          />
        </p>
      </div>
    ))
  
    return (
      <div>
        <h1>SSR: ë¬´ë¹„ ë¦¬ìŠ¤íŠ¸</h1>
        <div>{render}</div>
        <SetCookieButton token="myToken" content="abcdefg!!!" />
      </div>
    )
  }

1. í…ŒìŠ¤íŠ¸
  $ cd app1
  $ npm run dev
