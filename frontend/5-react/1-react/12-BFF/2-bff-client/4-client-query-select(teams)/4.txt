[Teams ì¡°íšŒí•˜ê¸°]

1. ì‚¬ì „ì¤€ë¹„: server ì•±ì„ ì¼œë‘”ë‹¤.
1. ì‚¬ì „ì¤€ë¹„: í”„ë¡œì íŠ¸ë¥¼ ìƒˆë¡œ ê¹”ì§€ ì•Šê³ , ì´ì „ ì±•í„°ì—ì„œì˜ ì½”ë“œë¥¼ ê·¸ëŒ€ë¡œ ì¹´í”¼í•´ì„œ ê°€ì§€ê³  ì˜¨ë‹¤.



1. src/components/teams.js ìˆ˜ì • : GraphQL ì„œë²„ë¡œë¶€í„° ëª©ë¡ ë°›ì•„ì™€ í‘œì‹œí•˜ê¸°
  import "./components.css"
  import { useState } from "react"
  import { useQuery, useMutation, gql } from "@apollo/client"

  // GraphQL ì„œë²„ë¡œë¶€í„° ëª¨ë“  ì»¨í…ì¸ ë¥¼ í‘œì‹œí•˜ê¸° ìœ„í•œ ì¿¼ë¦¬
  const GET_TEAMS = gql`
    query GetTeams {
      teams {
        id
        manager
        members {
          id
          first_name
          last_name
          role
        }
      }
    }
  `

  // GraphQL ì„œë²„ë¡œë¶€í„° idì— í•´ë‹¹í•˜ëŠ” ì»¨í…ì¸  í•˜ë‚˜ë§Œ ë°›ì•„ì™€ì„œ í‘œì‹œí•˜ê¸° ìœ„í•œ ì¿¼ë¦¬
  const GET_TEAM = gql`
    query GetTeam($id: ID!) {
      team(id: $id) {
        id
        manager
        office
        extension_number
        mascot
        cleaning_duty
        project
      }
    }
  `

  export default function Teams() {
    const [contentId, setContentId] = useState(0)
    const [inputs, setInputs] = useState({
      manager: "",
      office: "",
      extension_number: "",
      mascot: "",
      cleaning_duty: "",
      project: "",
    })

    // ì™¼ìª½ ì‚¬ì´ë“œë°” : GraphQLë¡œë¶€í„° ëª¨ë“  ë°ì´í„°ë¥¼ ë°›ì•„ì™€ ëª©ë¡ì„ ë Œë”ë§í•˜ë„ë¡ ì‘ì„±
    function AsideItems() {
      const roleIcons = {
        developer: "ğŸ’»",
        designer: "ğŸ¨",
        planner: "ğŸ“",
      }

      const { loading, error, data, refetch } = useQuery(GET_TEAMS)

      if (loading) return <p className="loading">Loading...</p>
      if (error) return <p className="error">Error :(</p>
      // GET_TEAMS ì¿¼ë¦¬ ì‘ë‹µì„ ì½˜ì†”ë¡œê·¸ì— ì°ëŠ”ë‹¤.
      if (data) {
        console.log("GET_TEAMS ì¿¼ë¦¬ ì‘ë‹µ: ", data)
      }

      return (
        <ul>
          {data.teams.map(({ id, manager, members }) => {
            return (
              <li key={id}>
                <span
                  className="teamItemTitle"
                  onClick={() => {
                    setContentId(id)
                  }}
                >
                  Team {id} : {manager}'s
                </span>
                <ul className="teamMembers">
                  {members.map(({ id, first_name, last_name, role }) => {
                    return (
                      <li key={id}>
                        {roleIcons[role]} {first_name} {last_name}
                      </li>
                    )
                  })}
                </ul>
              </li>
            )
          })}
        </ul>
      )
    }

    // ê°€ìš´ë° ë©”ì¸ì»¨í…ì¸  : GraphQL ì„œë²„ë¡œë¶€í„° idë¡œ í•œê°œì˜ ì»¨í…ì¸  ë°›ì•„ì™€ í‘œì‹œí•˜ê¸°
    function MainContents() {
      const { loading, error, data } = useQuery(GET_TEAM, {
        variables: { id: contentId },
        onCompleted: (data) => {
          if (contentId === 0) {
            setInputs({
              manager: "",
              office: "",
              extension_number: "",
              mascot: "",
              cleaning_duty: "",
              project: "",
            })
          } else {
            setInputs({
              manager: data.team.manager,
              office: data.team.office,
              extension_number: data.team.extension_number,
              mascot: data.team.mascot,
              cleaning_duty: data.team.cleaning_duty,
              project: data.team.project,
            })
          }
        },
      })

      if (loading) return <p className="loading">Loading...</p>
      if (error) return <p className="error">Error :(</p>
      // GET_TEAM ì¿¼ë¦¬ ì‘ë‹µì„ ì½˜ì†”ë¡œê·¸ì— ì°ëŠ”ë‹¤.
      if (data) {
        console.log("GET_TEAM ì¿¼ë¦¬ ì‘ë‹µ: ", data)
      }

      function handleChange(e) {
        const { name, value } = e.target
        setInputs({
          ...inputs,
          [name]: value,
        })
      }

      return (
        <div className="inputContainer">
          <table>
            <tbody>
              {contentId !== 0 && (
                <tr>
                  <td>Id</td>
                  <td>{contentId}</td>
                </tr>
              )}
              <tr>
                <td>Manager</td>
                <td>
                  <input
                    type="text"
                    name="manager"
                    value={inputs.manager}
                    onChange={handleChange}
                  />
                </td>
              </tr>
              <tr>
                <td>Office</td>
                <td>
                  <input
                    type="text"
                    name="office"
                    value={inputs.office}
                    onChange={handleChange}
                  />
                </td>
              </tr>
              <tr>
                <td>Extension Number</td>
                <td>
                  <input
                    type="text"
                    name="extension_number"
                    value={inputs.extension_number}
                    onChange={handleChange}
                  />
                </td>
              </tr>
              <tr>
                <td>Mascot</td>
                <td>
                  <input
                    type="text"
                    name="mascot"
                    value={inputs.mascot}
                    onChange={handleChange}
                  />
                </td>
              </tr>
              <tr>
                <td>Cleaning Duty</td>
                <td>
                  <input
                    type="text"
                    name="cleaning_duty"
                    value={inputs.cleaning_duty}
                    onChange={handleChange}
                  />
                </td>
              </tr>
              <tr>
                <td>Project</td>
                <td>
                  <input
                    type="text"
                    name="project"
                    value={inputs.project}
                    onChange={handleChange}
                  />
                </td>
              </tr>
            </tbody>
          </table>
          {contentId === 0 ? (
            <div className="buttons">
              <button onClick={() => {}}>Submit</button>
            </div>
          ) : (
            <div className="buttons">
              <button onClick={() => {}}>Modify</button>
              <button onClick={() => {}}>Delete</button>
              <button
                onClick={() => {
                  setContentId(0)
                }}
              >
                New
              </button>
            </div>
          )}
        </div>
      )
    }

    return (
      <div id="teams" className="component">
        <aside>{AsideItems()}</aside>
        <section className="contents">{MainContents()}</section>
      </div>
    )
  }



1. í…ŒìŠ¤íŠ¸ : Teams í™”ë©´ì—ì„œ ì‚¬ì´ë“œë°”ì™€ ì»¨í…ì¸  ë¶€ë¶„ì´ ì˜ í‘œì‹œë˜ëŠ”ì§€ í™•ì¸
  BFF server ì•± ì¼œì ¸ìˆëŠ”ì§€ í™•ì¸í•˜ê³ , êº¼ì ¸ìˆë‹¤ë©´ npm startë¡œ ì‹¤í–‰ì‹œì¼œë‘ê³  ì‹œì‘í•œë‹¤.
  $ cd app1
  $ npm start
  http://localhost:3000
  ìƒë‹¨ì˜ Teams ë©”ë‰´ í´ë¦­
  Team 1 : Mandy Warren's í´ë¦­í•´ì„œ, ì»¨í…ì¸  ì¸í’‹ì— íŒ€ ì •ë³´ë¡œ ì±„ì›Œì§€ë‚˜ í™•ì¸
  ë‹¤ë¥¸ íŒ€ë„ í´ë¦­í•´ë³´ê¸°
