[Interface íƒ€ì…]

1. ì‚¬ì „ì¤€ë¹„ : í”„ë¡œì íŠ¸ë¥¼ ìƒˆë¡œ ê¹”ì§€ ì•Šê³ , ì´ì „ ì±•í„°ì—ì„œì˜ ì½”ë“œë¥¼ ê·¸ëŒ€ë¡œ ì¹´í”¼í•´ì„œ ê°€ì§€ê³  ì˜¨ë‹¤.

1. Interface íƒ€ì…
  ìœ ì‚¬í•œ ê°ì²´ íƒ€ì…ì„ ë§Œë“¤ê¸° ìœ„í•œ ê³µí†µ í•„ë“œ íƒ€ì…ì´ë‹¤.
  ì¶”ìƒ íƒ€ì…(ë‹¤ë¥¸ íƒ€ì…ì— implement ë˜ê¸° ìœ„í•œ íƒ€ì…)ì´ë‹¤.



1. typedefs-resolvers/tools.js ìƒì„± : Equipmentì™€ Softwareê°€ ê³µí†µì ìœ¼ë¡œ ê°€ì§„ í•„ë“œì¸ "id, used_by"ë¥¼ ì´ìš©í•´, "tools"ë¼ëŠ” ì¿¼ë¦¬ì˜ typeDefs, resolversë¥¼ ì‘ì„±
  const { gql } = require("apollo-server")

  // ì¸í„°í˜ì´ìŠ¤ íƒ€ì…ì„ ì •ì˜í•œë‹¤.
  const typeDefs = gql`
    interface Tool {
      id: ID!
      used_by: Role!
    }
  `

  const resolvers = {
    Tool: {
      __resolveType(tool, context, info) {
        if (tool.developed_by) {
          return "Software"
        }
        if (tool.new_or_used) {
          return "Equipment"
        }
        return null
      },
    },
  }

  module.exports = {
    typeDefs: typeDefs,
    resolvers: resolvers,
  }



1. typedefs-resolvers/equipments.js ìˆ˜ì • : typeDefsì— Equipment ì¿¼ë¦¬ì˜ íƒ€ì… aliasê°€ Toolsë¥¼ ìƒì†ë°›ë„ë¡ ìˆ˜ì •í•˜ê³ , ê°™ì€ ë°©ì‹ì˜ Software ì¿¼ë¦¬ì˜ íƒ€ì… aliasë„ í•˜ë‚˜ ì¶”ê°€
  const { gql } = require("apollo-server")
  const dbWorks = require("../dbWorks")

  // implements Tool ëª…ë ¹ì–´ë¥¼ í†µí•´ Tool ì¸í„°í˜ì´ìŠ¤ë¥¼ ì ìš©í•œë‹¤.
  const typeDefs = gql`
    type Equipment implements Tool {
      id: ID!
      used_by: Role!
      count: Int
      new_or_used: NewOrUsed!
    }
    type Software implements Tool {
      id: ID!
      used_by: Role!
      developed_by: String!
      description: String
    }
    type EquipmentAdv {
      id: ID!
      used_by: String!
      count: Int!
      use_rate: Float
      is_new: Boolean!
      users: [String!]
    }
  `

  const resolvers = {
    Query: {
      equipments: (parent, args) => dbWorks.getEquipments(args),
      equipmentAdvs: (parent, args) =>
        dbWorks.getEquipments(args).map((equipment) => {
          if (equipment.used_by === "developer") {
            equipment.use_rate = Math.random().toFixed(2)
          }
          equipment.is_new = equipment.new_or_used === "new"
          // 50% í™•ë¥ ë¡œ equipmentAdvs í•­ëª©ì— users ë°°ì—´ì„ ì¶”ê°€í•˜ê³ , ê·¸ ì•ˆì— 20% í™•ë¥ ë¡œ ê°œë°œìë¥¼ ë„£ëŠ”ë‹¤.
          if (Math.random() > 0.5) {
            equipment.users = []
            dbWorks.getPeople(args).forEach((person) => {
              if (person.role === equipment.used_by && Math.random() < 0.2) {
                equipment.users.push(person.last_name)
              }
            })
          }
          return equipment
        }),
    },

    Mutation: {
      deleteEquipment: (parent, args) => dbWorks.deleteItem("equipments", args),
    },
  }

  module.exports = {
    typeDefs: typeDefs,
    resolvers: resolvers,
  }



1. index.js ìˆ˜ì • : ëª¨ë“ˆí™”ëœ toolsì˜ typeDefs, resolvers ì¶”ê°€
  const { ApolloServer } = require("apollo-server")
  const _ = require("lodash")

  const queries = require("./typedefs-resolvers/_queries")
  const mutations = require("./typedefs-resolvers/_mutations")
  const enums = require("./typedefs-resolvers/_enums")
  const equipments = require("./typedefs-resolvers/equipments")
  const supplies = require("./typedefs-resolvers/supplies")
  const softwares = require("./typedefs-resolvers/softwares")
  const givens = require("./typedefs-resolvers/givens")
  const tools = require("./typedefs-resolvers/tools")

  const typeDefs = [
    queries,
    mutations,
    enums,
    equipments.typeDefs,
    supplies.typeDefs,
    softwares.typeDefs,
    givens.typeDefs,
    tools.typeDefs,
  ]

  const resolvers = [
    equipments.resolvers,
    supplies.resolvers,
    softwares.resolvers,
    givens.resolvers,
    tools.resolvers,
  ]

  const server = new ApolloServer({ typeDefs, resolvers })

  server.listen().then(({ url }) => {
    console.log(`ğŸš€  Server ready at ${url}`)
  })



1. í…ŒìŠ¤íŠ¸
  $ cd app1
  $ npm start
  http://localhost:4000/ ì ‘ì† : GraphQL Playgroundê°€ ì—´ë¦°ë‹¤.
  GraphQL Playground ì‚¬ìš© : ì¢Œì¸¡ì— ë‹¤ìŒ ì¿¼ë¦¬ë¥¼ ë„£ê³  Runì„ í´ë¦­
    query {
      equipments {
        id
        used_by
        count
        new_or_used
      }
      softwares {
        id
        used_by
        description
        developed_by
      }
    }
  ê°ê° Tool ì¸í„°í˜ì´ìŠ¤ë¥¼ ì ìš©í•˜ê³ ë„, equipments, softwares ë°ì´í„°ê°€ ë³€í•¨ì—†ì´ ì´ìƒì—†ì´ ì¡°íšŒë˜ëŠ”ì§€ í™•ì¸í•œë‹¤.
