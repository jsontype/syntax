[Union íƒ€ì…]

1. ì‚¬ì „ì¤€ë¹„ : í”„ë¡œì íŠ¸ë¥¼ ìƒˆë¡œ ê¹”ì§€ ì•Šê³ , ì´ì „ ì±•í„°ì—ì„œì˜ ì½”ë“œë¥¼ ê·¸ëŒ€ë¡œ ì¹´í”¼í•´ì„œ ê°€ì§€ê³  ì˜¨ë‹¤.

1. Union íƒ€ì…
  í•˜ë‚˜ì˜ í•„ë“œì— ì—¬ëŸ¬ê°œë¥¼ íƒ€ì…ì„ ì‚¬ìš©í•  ë•Œ ì“´ë‹¤.
  ë²„í‹°ì»¬ ë°”(|)ë¥¼ ì‚¬ìš©í•´ì„œ ì—¬ëŸ¬ íƒ€ì…ì„ ì„ ì–¸í•  ìˆ˜ ìˆë‹¤.




1. typedefs-resolvers/givens.js ìƒì„±: ë‘˜ ì¤‘ í•˜ë‚˜ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ìˆëŠ” ìœ ë‹ˆì˜¨ íƒ€ì…ìœ¼ë¡œ ëœ Givenì˜ typeDefsì™€ resolvers ì„¤ì •
  const { gql } = require("apollo-server")
  const dbWorks = require("../dbWorks.js")

  const typeDefs = gql`
    union Given = Equipment | Supply
  `

  const resolvers = {
    Query: {
      givens: (parent, args) => {
        return [...dbWorks.getEquipments(args), ...dbWorks.getSupplies(args)]
      },
    },
    Given: {
      __resolveType(given, context, info) {
        if (given.used_by) {
          return "Equipment"
        }
        if (given.team) {
          return "Supply"
        }
        return null
      },
    },
  }

  module.exports = {
    typeDefs: typeDefs,
    resolvers: resolvers,
  }



1. typedefs-resolvers/_queries.js ìˆ˜ì • : givens ì¿¼ë¦¬ì˜ íƒ€ì…ì„ ì¶”ê°€
  const { gql } = require("apollo-server")

  const typeDefs = gql`
    type Query {
      equipments: [Equipment]
      supplies: [Supply]
      equipmentAdvs: [EquipmentAdv]
      softwares: [Software]
      software: Software
      givens: [Given]
    }
  `

  module.exports = typeDefs



1. index.js ìˆ˜ì • : ëª¨ë“ˆí™”ëœ givensì˜ typeDefs, resolvers ì¶”ê°€
  const { ApolloServer } = require("apollo-server")
  const _ = require("lodash")

  const queries = require("./typedefs-resolvers/_queries")
  const mutations = require("./typedefs-resolvers/_mutations")
  const enums = require("./typedefs-resolvers/_enums")
  const equipments = require("./typedefs-resolvers/equipments")
  const supplies = require("./typedefs-resolvers/supplies")
  const softwares = require("./typedefs-resolvers/softwares")
  const givens = require("./typedefs-resolvers/givens")

  const typeDefs = [
    queries,
    mutations,
    enums,
    equipments.typeDefs,
    supplies.typeDefs,
    softwares.typeDefs,
    givens.typeDefs,
  ]

  const resolvers = [
    equipments.resolvers,
    supplies.resolvers,
    softwares.resolvers,
    givens.resolvers,
  ]

  const server = new ApolloServer({ typeDefs, resolvers })

  server.listen().then(({ url }) => {
    console.log(`ğŸš€  Server ready at ${url}`)
  })



1. í…ŒìŠ¤íŠ¸
  $ cd app1
  $ npm start
  http://localhost:4000/ ì ‘ì† : GraphQL Playgroundê°€ ì—´ë¦°ë‹¤.
  GraphQL Playground ì‚¬ìš© : ì¢Œì¸¡ì— ë‹¤ìŒ ì¿¼ë¦¬ë¥¼ ë„£ê³  Runì„ í´ë¦­
    query {
      givens {
        __typename
        ... on Equipment {
          id
          used_by
          count
          new_or_used
        }
        ... on Supply {
          id
          team
        }
      }
    }
  __typenameì€ ê° í•­ëª©ì´ Equipment ì¿¼ë¦¬ì™€ Supply ì¿¼ë¦¬ ì¤‘ ì–´ë–¤ ì¿¼ë¦¬ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë§Œë“¤ì–´ì¡ŒëŠ”ì§€ ì•Œë ¤ì¤€ë‹¤.
  ... on Equipment, ... on SupplyëŠ” í•´ë‹¹ ì¿¼ë¦¬ë¥¼ ë°›ì•„ì˜¬ ë•Œì˜ ì·¨ë“í•  í•„ë“œë¥¼ ì§€ì •í•´ì¤€ë‹¤.
  givens ë°ì´í„°ì•ˆì— Equipment ì¿¼ë¦¬ì™€ Supply ì¿¼ë¦¬ë¥¼ ê³µì¡´í•´ì„œ ë“¤ì–´ê°ˆ ìˆ˜ ìˆëŠ” ìƒíƒœì¸ì§€ ì¡°íšŒê°’ì„ í†µí•´ í™•ì¸í•œë‹¤.
