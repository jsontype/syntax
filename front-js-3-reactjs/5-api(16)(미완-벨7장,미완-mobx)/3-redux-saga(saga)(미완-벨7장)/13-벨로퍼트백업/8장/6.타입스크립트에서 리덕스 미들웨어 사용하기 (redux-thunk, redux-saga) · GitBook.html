<!DOCTYPE html>
<!-- saved from url=(0066)https://react.vlpt.us/using-typescript/06-ts-redux-middleware.html -->
<html lang=""><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><style>
    .utterances {
      position: relative;
      box-sizing: border-box;
      width: 100%;
      max-width: 760px;
      margin-left: auto;
      margin-right: auto;
    }
    .utterances-frame {
      color-scheme: light;
      position: absolute;
      left: 0;
      right: 0;
      width: 1px;
      min-width: 100%;
      max-width: 100%;
      height: 100%;
      border: 0;
    }
  </style><style>
    .utterances {
      position: relative;
      box-sizing: border-box;
      width: 100%;
      max-width: 760px;
      margin-left: auto;
      margin-right: auto;
    }
    .utterances-frame {
      color-scheme: light;
      position: absolute;
      left: 0;
      right: 0;
      width: 1px;
      min-width: 100%;
      max-width: 100%;
      height: 100%;
      border: 0;
    }
  </style><style>
    .utterances {
      position: relative;
      box-sizing: border-box;
      width: 100%;
      max-width: 760px;
      margin-left: auto;
      margin-right: auto;
    }
    .utterances-frame {
      color-scheme: light;
      position: absolute;
      left: 0;
      right: 0;
      width: 1px;
      min-width: 100%;
      max-width: 100%;
      height: 100%;
      border: 0;
    }
  </style><style>
    .utterances {
      position: relative;
      box-sizing: border-box;
      width: 100%;
      max-width: 760px;
      margin-left: auto;
      margin-right: auto;
    }
    .utterances-frame {
      color-scheme: light;
      position: absolute;
      left: 0;
      right: 0;
      width: 1px;
      min-width: 100%;
      max-width: 100%;
      height: 100%;
      border: 0;
    }
  </style><style>
    .utterances {
      position: relative;
      box-sizing: border-box;
      width: 100%;
      max-width: 760px;
      margin-left: auto;
      margin-right: auto;
    }
    .utterances-frame {
      color-scheme: light;
      position: absolute;
      left: 0;
      right: 0;
      width: 1px;
      min-width: 100%;
      max-width: 100%;
      height: 100%;
      border: 0;
    }
  </style><style>
    .utterances {
      position: relative;
      box-sizing: border-box;
      width: 100%;
      max-width: 760px;
      margin-left: auto;
      margin-right: auto;
    }
    .utterances-frame {
      color-scheme: light;
      position: absolute;
      left: 0;
      right: 0;
      width: 1px;
      min-width: 100%;
      max-width: 100%;
      height: 100%;
      border: 0;
    }
  </style><style>
    .utterances {
      position: relative;
      box-sizing: border-box;
      width: 100%;
      max-width: 760px;
      margin-left: auto;
      margin-right: auto;
    }
    .utterances-frame {
      color-scheme: light;
      position: absolute;
      left: 0;
      right: 0;
      width: 1px;
      min-width: 100%;
      max-width: 100%;
      height: 100%;
      border: 0;
    }
  </style><style>
    .utterances {
      position: relative;
      box-sizing: border-box;
      width: 100%;
      max-width: 760px;
      margin-left: auto;
      margin-right: auto;
    }
    .utterances-frame {
      color-scheme: light;
      position: absolute;
      left: 0;
      right: 0;
      width: 1px;
      min-width: 100%;
      max-width: 100%;
      height: 100%;
      border: 0;
    }
  </style><style>
    .utterances {
      position: relative;
      box-sizing: border-box;
      width: 100%;
      max-width: 760px;
      margin-left: auto;
      margin-right: auto;
    }
    .utterances-frame {
      color-scheme: light;
      position: absolute;
      left: 0;
      right: 0;
      width: 1px;
      min-width: 100%;
      max-width: 100%;
      height: 100%;
      border: 0;
    }
  </style><style>
    .utterances {
      position: relative;
      box-sizing: border-box;
      width: 100%;
      max-width: 760px;
      margin-left: auto;
      margin-right: auto;
    }
    .utterances-frame {
      color-scheme: light;
      position: absolute;
      left: 0;
      right: 0;
      width: 1px;
      min-width: 100%;
      max-width: 100%;
      height: 100%;
      border: 0;
    }
  </style><style>
    .utterances {
      position: relative;
      box-sizing: border-box;
      width: 100%;
      max-width: 760px;
      margin-left: auto;
      margin-right: auto;
    }
    .utterances-frame {
      color-scheme: light;
      position: absolute;
      left: 0;
      right: 0;
      width: 1px;
      min-width: 100%;
      max-width: 100%;
      height: 100%;
      border: 0;
    }
  </style><style>
    .utterances {
      position: relative;
      box-sizing: border-box;
      width: 100%;
      max-width: 760px;
      margin-left: auto;
      margin-right: auto;
    }
    .utterances-frame {
      color-scheme: light;
      position: absolute;
      left: 0;
      right: 0;
      width: 1px;
      min-width: 100%;
      max-width: 100%;
      height: 100%;
      border: 0;
    }
  </style><style>
    .utterances {
      position: relative;
      box-sizing: border-box;
      width: 100%;
      max-width: 760px;
      margin-left: auto;
      margin-right: auto;
    }
    .utterances-frame {
      color-scheme: light;
      position: absolute;
      left: 0;
      right: 0;
      width: 1px;
      min-width: 100%;
      max-width: 100%;
      height: 100%;
      border: 0;
    }
  </style><style>
    .utterances {
      position: relative;
      box-sizing: border-box;
      width: 100%;
      max-width: 760px;
      margin-left: auto;
      margin-right: auto;
    }
    .utterances-frame {
      color-scheme: light;
      position: absolute;
      left: 0;
      right: 0;
      width: 1px;
      min-width: 100%;
      max-width: 100%;
      height: 100%;
      border: 0;
    }
  </style><style>
    .utterances {
      position: relative;
      box-sizing: border-box;
      width: 100%;
      max-width: 760px;
      margin-left: auto;
      margin-right: auto;
    }
    .utterances-frame {
      color-scheme: light;
      position: absolute;
      left: 0;
      right: 0;
      width: 1px;
      min-width: 100%;
      max-width: 100%;
      height: 100%;
      border: 0;
    }
  </style><style>
    .utterances {
      position: relative;
      box-sizing: border-box;
      width: 100%;
      max-width: 760px;
      margin-left: auto;
      margin-right: auto;
    }
    .utterances-frame {
      color-scheme: light;
      position: absolute;
      left: 0;
      right: 0;
      width: 1px;
      min-width: 100%;
      max-width: 100%;
      height: 100%;
      border: 0;
    }
  </style><style>
    .utterances {
      position: relative;
      box-sizing: border-box;
      width: 100%;
      max-width: 760px;
      margin-left: auto;
      margin-right: auto;
    }
    .utterances-frame {
      color-scheme: light;
      position: absolute;
      left: 0;
      right: 0;
      width: 1px;
      min-width: 100%;
      max-width: 100%;
      height: 100%;
      border: 0;
    }
  </style><style>
    .utterances {
      position: relative;
      box-sizing: border-box;
      width: 100%;
      max-width: 760px;
      margin-left: auto;
      margin-right: auto;
    }
    .utterances-frame {
      color-scheme: light;
      position: absolute;
      left: 0;
      right: 0;
      width: 1px;
      min-width: 100%;
      max-width: 100%;
      height: 100%;
      border: 0;
    }
  </style><style>
    .utterances {
      position: relative;
      box-sizing: border-box;
      width: 100%;
      max-width: 760px;
      margin-left: auto;
      margin-right: auto;
    }
    .utterances-frame {
      color-scheme: light;
      position: absolute;
      left: 0;
      right: 0;
      width: 1px;
      min-width: 100%;
      max-width: 100%;
      height: 100%;
      border: 0;
    }
  </style><style>
    .utterances {
      position: relative;
      box-sizing: border-box;
      width: 100%;
      max-width: 760px;
      margin-left: auto;
      margin-right: auto;
    }
    .utterances-frame {
      color-scheme: light;
      position: absolute;
      left: 0;
      right: 0;
      width: 1px;
      min-width: 100%;
      max-width: 100%;
      height: 100%;
      border: 0;
    }
  </style><style>
    .utterances {
      position: relative;
      box-sizing: border-box;
      width: 100%;
      max-width: 760px;
      margin-left: auto;
      margin-right: auto;
    }
    .utterances-frame {
      color-scheme: light;
      position: absolute;
      left: 0;
      right: 0;
      width: 1px;
      min-width: 100%;
      max-width: 100%;
      height: 100%;
      border: 0;
    }
  </style><style>
    .utterances {
      position: relative;
      box-sizing: border-box;
      width: 100%;
      max-width: 760px;
      margin-left: auto;
      margin-right: auto;
    }
    .utterances-frame {
      color-scheme: light;
      position: absolute;
      left: 0;
      right: 0;
      width: 1px;
      min-width: 100%;
      max-width: 100%;
      height: 100%;
      border: 0;
    }
  </style><style>
    .utterances {
      position: relative;
      box-sizing: border-box;
      width: 100%;
      max-width: 760px;
      margin-left: auto;
      margin-right: auto;
    }
    .utterances-frame {
      color-scheme: light;
      position: absolute;
      left: 0;
      right: 0;
      width: 1px;
      min-width: 100%;
      max-width: 100%;
      height: 100%;
      border: 0;
    }
  </style><style>
    .utterances {
      position: relative;
      box-sizing: border-box;
      width: 100%;
      max-width: 760px;
      margin-left: auto;
      margin-right: auto;
    }
    .utterances-frame {
      color-scheme: light;
      position: absolute;
      left: 0;
      right: 0;
      width: 1px;
      min-width: 100%;
      max-width: 100%;
      height: 100%;
      border: 0;
    }
  </style><style>
    .utterances {
      position: relative;
      box-sizing: border-box;
      width: 100%;
      max-width: 760px;
      margin-left: auto;
      margin-right: auto;
    }
    .utterances-frame {
      color-scheme: light;
      position: absolute;
      left: 0;
      right: 0;
      width: 1px;
      min-width: 100%;
      max-width: 100%;
      height: 100%;
      border: 0;
    }
  </style><style>
    .utterances {
      position: relative;
      box-sizing: border-box;
      width: 100%;
      max-width: 760px;
      margin-left: auto;
      margin-right: auto;
    }
    .utterances-frame {
      color-scheme: light;
      position: absolute;
      left: 0;
      right: 0;
      width: 1px;
      min-width: 100%;
      max-width: 100%;
      height: 100%;
      border: 0;
    }
  </style><style>
    .utterances {
      position: relative;
      box-sizing: border-box;
      width: 100%;
      max-width: 760px;
      margin-left: auto;
      margin-right: auto;
    }
    .utterances-frame {
      color-scheme: light;
      position: absolute;
      left: 0;
      right: 0;
      width: 1px;
      min-width: 100%;
      max-width: 100%;
      height: 100%;
      border: 0;
    }
  </style><style>
    .utterances {
      position: relative;
      box-sizing: border-box;
      width: 100%;
      max-width: 760px;
      margin-left: auto;
      margin-right: auto;
    }
    .utterances-frame {
      color-scheme: light;
      position: absolute;
      left: 0;
      right: 0;
      width: 1px;
      min-width: 100%;
      max-width: 100%;
      height: 100%;
      border: 0;
    }
  </style><style>
    .utterances {
      position: relative;
      box-sizing: border-box;
      width: 100%;
      max-width: 760px;
      margin-left: auto;
      margin-right: auto;
    }
    .utterances-frame {
      color-scheme: light;
      position: absolute;
      left: 0;
      right: 0;
      width: 1px;
      min-width: 100%;
      max-width: 100%;
      height: 100%;
      border: 0;
    }
  </style><style>
    .utterances {
      position: relative;
      box-sizing: border-box;
      width: 100%;
      max-width: 760px;
      margin-left: auto;
      margin-right: auto;
    }
    .utterances-frame {
      color-scheme: light;
      position: absolute;
      left: 0;
      right: 0;
      width: 1px;
      min-width: 100%;
      max-width: 100%;
      height: 100%;
      border: 0;
    }
  </style><style>
    .utterances {
      position: relative;
      box-sizing: border-box;
      width: 100%;
      max-width: 760px;
      margin-left: auto;
      margin-right: auto;
    }
    .utterances-frame {
      color-scheme: light;
      position: absolute;
      left: 0;
      right: 0;
      width: 1px;
      min-width: 100%;
      max-width: 100%;
      height: 100%;
      border: 0;
    }
  </style><style>
    .utterances {
      position: relative;
      box-sizing: border-box;
      width: 100%;
      max-width: 760px;
      margin-left: auto;
      margin-right: auto;
    }
    .utterances-frame {
      color-scheme: light;
      position: absolute;
      left: 0;
      right: 0;
      width: 1px;
      min-width: 100%;
      max-width: 100%;
      height: 100%;
      border: 0;
    }
  </style><style>
    .utterances {
      position: relative;
      box-sizing: border-box;
      width: 100%;
      max-width: 760px;
      margin-left: auto;
      margin-right: auto;
    }
    .utterances-frame {
      color-scheme: light;
      position: absolute;
      left: 0;
      right: 0;
      width: 1px;
      min-width: 100%;
      max-width: 100%;
      height: 100%;
      border: 0;
    }
  </style><style>
    .utterances {
      position: relative;
      box-sizing: border-box;
      width: 100%;
      max-width: 760px;
      margin-left: auto;
      margin-right: auto;
    }
    .utterances-frame {
      color-scheme: light;
      position: absolute;
      left: 0;
      right: 0;
      width: 1px;
      min-width: 100%;
      max-width: 100%;
      height: 100%;
      border: 0;
    }
  </style><style>
    .utterances {
      position: relative;
      box-sizing: border-box;
      width: 100%;
      max-width: 760px;
      margin-left: auto;
      margin-right: auto;
    }
    .utterances-frame {
      color-scheme: light;
      position: absolute;
      left: 0;
      right: 0;
      width: 1px;
      min-width: 100%;
      max-width: 100%;
      height: 100%;
      border: 0;
    }
  </style><style>
    .utterances {
      position: relative;
      box-sizing: border-box;
      width: 100%;
      max-width: 760px;
      margin-left: auto;
      margin-right: auto;
    }
    .utterances-frame {
      color-scheme: light;
      position: absolute;
      left: 0;
      right: 0;
      width: 1px;
      min-width: 100%;
      max-width: 100%;
      height: 100%;
      border: 0;
    }
  </style><style>
    .utterances {
      position: relative;
      box-sizing: border-box;
      width: 100%;
      max-width: 760px;
      margin-left: auto;
      margin-right: auto;
    }
    .utterances-frame {
      color-scheme: light;
      position: absolute;
      left: 0;
      right: 0;
      width: 1px;
      min-width: 100%;
      max-width: 100%;
      height: 100%;
      border: 0;
    }
  </style><style>
    .utterances {
      position: relative;
      box-sizing: border-box;
      width: 100%;
      max-width: 760px;
      margin-left: auto;
      margin-right: auto;
    }
    .utterances-frame {
      color-scheme: light;
      position: absolute;
      left: 0;
      right: 0;
      width: 1px;
      min-width: 100%;
      max-width: 100%;
      height: 100%;
      border: 0;
    }
  </style><style>
    .utterances {
      position: relative;
      box-sizing: border-box;
      width: 100%;
      max-width: 760px;
      margin-left: auto;
      margin-right: auto;
    }
    .utterances-frame {
      color-scheme: light;
      position: absolute;
      left: 0;
      right: 0;
      width: 1px;
      min-width: 100%;
      max-width: 100%;
      height: 100%;
      border: 0;
    }
  </style><style>
    .utterances {
      position: relative;
      box-sizing: border-box;
      width: 100%;
      max-width: 760px;
      margin-left: auto;
      margin-right: auto;
    }
    .utterances-frame {
      color-scheme: light;
      position: absolute;
      left: 0;
      right: 0;
      width: 1px;
      min-width: 100%;
      max-width: 100%;
      height: 100%;
      border: 0;
    }
  </style><style>
    .utterances {
      position: relative;
      box-sizing: border-box;
      width: 100%;
      max-width: 760px;
      margin-left: auto;
      margin-right: auto;
    }
    .utterances-frame {
      color-scheme: light;
      position: absolute;
      left: 0;
      right: 0;
      width: 1px;
      min-width: 100%;
      max-width: 100%;
      height: 100%;
      border: 0;
    }
  </style><style>
    .utterances {
      position: relative;
      box-sizing: border-box;
      width: 100%;
      max-width: 760px;
      margin-left: auto;
      margin-right: auto;
    }
    .utterances-frame {
      color-scheme: light;
      position: absolute;
      left: 0;
      right: 0;
      width: 1px;
      min-width: 100%;
      max-width: 100%;
      height: 100%;
      border: 0;
    }
  </style><style>
    .utterances {
      position: relative;
      box-sizing: border-box;
      width: 100%;
      max-width: 760px;
      margin-left: auto;
      margin-right: auto;
    }
    .utterances-frame {
      color-scheme: light;
      position: absolute;
      left: 0;
      right: 0;
      width: 1px;
      min-width: 100%;
      max-width: 100%;
      height: 100%;
      border: 0;
    }
  </style><style>
    .utterances {
      position: relative;
      box-sizing: border-box;
      width: 100%;
      max-width: 760px;
      margin-left: auto;
      margin-right: auto;
    }
    .utterances-frame {
      color-scheme: light;
      position: absolute;
      left: 0;
      right: 0;
      width: 1px;
      min-width: 100%;
      max-width: 100%;
      height: 100%;
      border: 0;
    }
  </style><style>
    .utterances {
      position: relative;
      box-sizing: border-box;
      width: 100%;
      max-width: 760px;
      margin-left: auto;
      margin-right: auto;
    }
    .utterances-frame {
      color-scheme: light;
      position: absolute;
      left: 0;
      right: 0;
      width: 1px;
      min-width: 100%;
      max-width: 100%;
      height: 100%;
      border: 0;
    }
  </style><style>
    .utterances {
      position: relative;
      box-sizing: border-box;
      width: 100%;
      max-width: 760px;
      margin-left: auto;
      margin-right: auto;
    }
    .utterances-frame {
      color-scheme: light;
      position: absolute;
      left: 0;
      right: 0;
      width: 1px;
      min-width: 100%;
      max-width: 100%;
      height: 100%;
      border: 0;
    }
  </style><style>
    .utterances {
      position: relative;
      box-sizing: border-box;
      width: 100%;
      max-width: 760px;
      margin-left: auto;
      margin-right: auto;
    }
    .utterances-frame {
      color-scheme: light;
      position: absolute;
      left: 0;
      right: 0;
      width: 1px;
      min-width: 100%;
      max-width: 100%;
      height: 100%;
      border: 0;
    }
  </style><style>
    .utterances {
      position: relative;
      box-sizing: border-box;
      width: 100%;
      max-width: 760px;
      margin-left: auto;
      margin-right: auto;
    }
    .utterances-frame {
      color-scheme: light;
      position: absolute;
      left: 0;
      right: 0;
      width: 1px;
      min-width: 100%;
      max-width: 100%;
      height: 100%;
      border: 0;
    }
  </style><style>
    .utterances {
      position: relative;
      box-sizing: border-box;
      width: 100%;
      max-width: 760px;
      margin-left: auto;
      margin-right: auto;
    }
    .utterances-frame {
      color-scheme: light;
      position: absolute;
      left: 0;
      right: 0;
      width: 1px;
      min-width: 100%;
      max-width: 100%;
      height: 100%;
      border: 0;
    }
  </style><style>
    .utterances {
      position: relative;
      box-sizing: border-box;
      width: 100%;
      max-width: 760px;
      margin-left: auto;
      margin-right: auto;
    }
    .utterances-frame {
      color-scheme: light;
      position: absolute;
      left: 0;
      right: 0;
      width: 1px;
      min-width: 100%;
      max-width: 100%;
      height: 100%;
      border: 0;
    }
  </style><style>
    .utterances {
      position: relative;
      box-sizing: border-box;
      width: 100%;
      max-width: 760px;
      margin-left: auto;
      margin-right: auto;
    }
    .utterances-frame {
      color-scheme: light;
      position: absolute;
      left: 0;
      right: 0;
      width: 1px;
      min-width: 100%;
      max-width: 100%;
      height: 100%;
      border: 0;
    }
  </style><style>
    .utterances {
      position: relative;
      box-sizing: border-box;
      width: 100%;
      max-width: 760px;
      margin-left: auto;
      margin-right: auto;
    }
    .utterances-frame {
      color-scheme: light;
      position: absolute;
      left: 0;
      right: 0;
      width: 1px;
      min-width: 100%;
      max-width: 100%;
      height: 100%;
      border: 0;
    }
  </style><style>
    .utterances {
      position: relative;
      box-sizing: border-box;
      width: 100%;
      max-width: 760px;
      margin-left: auto;
      margin-right: auto;
    }
    .utterances-frame {
      color-scheme: light;
      position: absolute;
      left: 0;
      right: 0;
      width: 1px;
      min-width: 100%;
      max-width: 100%;
      height: 100%;
      border: 0;
    }
  </style><style>
    .utterances {
      position: relative;
      box-sizing: border-box;
      width: 100%;
      max-width: 760px;
      margin-left: auto;
      margin-right: auto;
    }
    .utterances-frame {
      color-scheme: light;
      position: absolute;
      left: 0;
      right: 0;
      width: 1px;
      min-width: 100%;
      max-width: 100%;
      height: 100%;
      border: 0;
    }
  </style><style>
    .utterances {
      position: relative;
      box-sizing: border-box;
      width: 100%;
      max-width: 760px;
      margin-left: auto;
      margin-right: auto;
    }
    .utterances-frame {
      color-scheme: light;
      position: absolute;
      left: 0;
      right: 0;
      width: 1px;
      min-width: 100%;
      max-width: 100%;
      height: 100%;
      border: 0;
    }
  </style><style>
    .utterances {
      position: relative;
      box-sizing: border-box;
      width: 100%;
      max-width: 760px;
      margin-left: auto;
      margin-right: auto;
    }
    .utterances-frame {
      color-scheme: light;
      position: absolute;
      left: 0;
      right: 0;
      width: 1px;
      min-width: 100%;
      max-width: 100%;
      height: 100%;
      border: 0;
    }
  </style><style>
    .utterances {
      position: relative;
      box-sizing: border-box;
      width: 100%;
      max-width: 760px;
      margin-left: auto;
      margin-right: auto;
    }
    .utterances-frame {
      color-scheme: light;
      position: absolute;
      left: 0;
      right: 0;
      width: 1px;
      min-width: 100%;
      max-width: 100%;
      height: 100%;
      border: 0;
    }
  </style><style>
    .utterances {
      position: relative;
      box-sizing: border-box;
      width: 100%;
      max-width: 760px;
      margin-left: auto;
      margin-right: auto;
    }
    .utterances-frame {
      color-scheme: light;
      position: absolute;
      left: 0;
      right: 0;
      width: 1px;
      min-width: 100%;
      max-width: 100%;
      height: 100%;
      border: 0;
    }
  </style><style>
    .utterances {
      position: relative;
      box-sizing: border-box;
      width: 100%;
      max-width: 760px;
      margin-left: auto;
      margin-right: auto;
    }
    .utterances-frame {
      color-scheme: light;
      position: absolute;
      left: 0;
      right: 0;
      width: 1px;
      min-width: 100%;
      max-width: 100%;
      height: 100%;
      border: 0;
    }
  </style><style>
    .utterances {
      position: relative;
      box-sizing: border-box;
      width: 100%;
      max-width: 760px;
      margin-left: auto;
      margin-right: auto;
    }
    .utterances-frame {
      color-scheme: light;
      position: absolute;
      left: 0;
      right: 0;
      width: 1px;
      min-width: 100%;
      max-width: 100%;
      height: 100%;
      border: 0;
    }
  </style><style>
    .utterances {
      position: relative;
      box-sizing: border-box;
      width: 100%;
      max-width: 760px;
      margin-left: auto;
      margin-right: auto;
    }
    .utterances-frame {
      color-scheme: light;
      position: absolute;
      left: 0;
      right: 0;
      width: 1px;
      min-width: 100%;
      max-width: 100%;
      height: 100%;
      border: 0;
    }
  </style><style>
    .utterances {
      position: relative;
      box-sizing: border-box;
      width: 100%;
      max-width: 760px;
      margin-left: auto;
      margin-right: auto;
    }
    .utterances-frame {
      color-scheme: light;
      position: absolute;
      left: 0;
      right: 0;
      width: 1px;
      min-width: 100%;
      max-width: 100%;
      height: 100%;
      border: 0;
    }
  </style><style>
    .utterances {
      position: relative;
      box-sizing: border-box;
      width: 100%;
      max-width: 760px;
      margin-left: auto;
      margin-right: auto;
    }
    .utterances-frame {
      color-scheme: light;
      position: absolute;
      left: 0;
      right: 0;
      width: 1px;
      min-width: 100%;
      max-width: 100%;
      height: 100%;
      border: 0;
    }
  </style><style>
    .utterances {
      position: relative;
      box-sizing: border-box;
      width: 100%;
      max-width: 760px;
      margin-left: auto;
      margin-right: auto;
    }
    .utterances-frame {
      color-scheme: light;
      position: absolute;
      left: 0;
      right: 0;
      width: 1px;
      min-width: 100%;
      max-width: 100%;
      height: 100%;
      border: 0;
    }
  </style><style>
    .utterances {
      position: relative;
      box-sizing: border-box;
      width: 100%;
      max-width: 760px;
      margin-left: auto;
      margin-right: auto;
    }
    .utterances-frame {
      color-scheme: light;
      position: absolute;
      left: 0;
      right: 0;
      width: 1px;
      min-width: 100%;
      max-width: 100%;
      height: 100%;
      border: 0;
    }
  </style><style>
    .utterances {
      position: relative;
      box-sizing: border-box;
      width: 100%;
      max-width: 760px;
      margin-left: auto;
      margin-right: auto;
    }
    .utterances-frame {
      color-scheme: light;
      position: absolute;
      left: 0;
      right: 0;
      width: 1px;
      min-width: 100%;
      max-width: 100%;
      height: 100%;
      border: 0;
    }
  </style><style>
    .utterances {
      position: relative;
      box-sizing: border-box;
      width: 100%;
      max-width: 760px;
      margin-left: auto;
      margin-right: auto;
    }
    .utterances-frame {
      color-scheme: light;
      position: absolute;
      left: 0;
      right: 0;
      width: 1px;
      min-width: 100%;
      max-width: 100%;
      height: 100%;
      border: 0;
    }
  </style><style>
    .utterances {
      position: relative;
      box-sizing: border-box;
      width: 100%;
      max-width: 760px;
      margin-left: auto;
      margin-right: auto;
    }
    .utterances-frame {
      color-scheme: light;
      position: absolute;
      left: 0;
      right: 0;
      width: 1px;
      min-width: 100%;
      max-width: 100%;
      height: 100%;
      border: 0;
    }
  </style><style>
    .utterances {
      position: relative;
      box-sizing: border-box;
      width: 100%;
      max-width: 760px;
      margin-left: auto;
      margin-right: auto;
    }
    .utterances-frame {
      color-scheme: light;
      position: absolute;
      left: 0;
      right: 0;
      width: 1px;
      min-width: 100%;
      max-width: 100%;
      height: 100%;
      border: 0;
    }
  </style>


<title>6.타입스크립트에서 리덕스 미들웨어 사용하기 (redux-thunk, redux-saga) · GitBook</title>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="description" content="">
<meta name="generator" content="GitBook 3.2.3">
<link rel="stylesheet" href="./6.타입스크립트에서 리덕스 미들웨어 사용하기 (redux-thunk, redux-saga) · GitBook_files/style.css">
<link rel="stylesheet" href="./6.타입스크립트에서 리덕스 미들웨어 사용하기 (redux-thunk, redux-saga) · GitBook_files/collapsible-chapters.css">
<link rel="stylesheet" href="./6.타입스크립트에서 리덕스 미들웨어 사용하기 (redux-thunk, redux-saga) · GitBook_files/website.css">
<link rel="stylesheet" href="./6.타입스크립트에서 리덕스 미들웨어 사용하기 (redux-thunk, redux-saga) · GitBook_files/search.css">
<link rel="stylesheet" href="./6.타입스크립트에서 리덕스 미들웨어 사용하기 (redux-thunk, redux-saga) · GitBook_files/website(1).css">
<meta name="HandheldFriendly" content="true">
<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black">
<link rel="apple-touch-icon-precomposed" sizes="152x152" href="https://react.vlpt.us/gitbook/images/apple-touch-icon-precomposed-152.png">
<link rel="shortcut icon" href="https://react.vlpt.us/gitbook/images/favicon.ico" type="image/x-icon">


<link rel="prev" href="https://react.vlpt.us/using-typescript/05-ts-redux.html"></head>
<body>
<div class="book without-animation with-summary font-size-2 font-family-1">
<div class="book-summary">
<div id="book-search-input" role="search">
<input type="text" placeholder="Type to search">
</div>
<nav role="navigation">
<ul class="summary">
<li class="chapter " data-level="1.1" data-path="../">
<a href="https://react.vlpt.us/">
벨로퍼트와 함께하는 모던 리액트
</a>
</li>
<li class="chapter " data-level="1.2" data-path="../basic/">
<a href="https://react.vlpt.us/basic/">
1장. 리액트 입문
<i class="exc-trigger fa"></i></a>
<ul class="articles">
<li class="chapter " data-level="1.2.1" data-path="../basic/01-concept.html">
<a href="https://react.vlpt.us/basic/01-concept.html">
1. 리액트는 어쩌다가 만들어졌을까?
</a>
</li>
<li class="chapter " data-level="1.2.2" data-path="../basic/02-prepare.html">
<a href="https://react.vlpt.us/basic/02-prepare.html">
2. 작업환경 준비
</a>
</li>
<li class="chapter " data-level="1.2.3" data-path="../basic/03-first-component.html">
<a href="https://react.vlpt.us/basic/03-first-component.html">
3. 나의 첫번째 리액트 컴포넌트
</a>
</li>
<li class="chapter " data-level="1.2.4" data-path="../basic/04-jsx.html">
<a href="https://react.vlpt.us/basic/04-jsx.html">
4. JSX
</a>
</li>
<li class="chapter " data-level="1.2.5" data-path="../basic/05-props.html">
<a href="https://react.vlpt.us/basic/05-props.html">
5. props 를 통해 컴포넌트에게 값 전달하기
</a>
</li>
<li class="chapter " data-level="1.2.6" data-path="../basic/06-conditional-rendering.html">
<a href="https://react.vlpt.us/basic/06-conditional-rendering.html">
6. 조건부 렌더링
</a>
</li>
<li class="chapter " data-level="1.2.7" data-path="../basic/07-useState.html">
<a href="https://react.vlpt.us/basic/07-useState.html">
7. useState 를 통해 컴포넌트에서 바뀌는 값 관리하기
</a>
</li>
<li class="chapter " data-level="1.2.8" data-path="../basic/08-manage-input.html">
<a href="https://react.vlpt.us/basic/08-manage-input.html">
8. input 상태 관리하기
</a>
</li>
<li class="chapter expanded" data-level="1.2.9" data-path="../basic/09-multiple-inputs.html">
<a href="https://react.vlpt.us/basic/09-multiple-inputs.html">
9. 여러개의 input 상태 관리하기
</a>
</li>
<li class="chapter " data-level="1.2.10" data-path="../basic/10-useRef.html">
<a href="https://react.vlpt.us/basic/10-useRef.html">
10. useRef 로 특정 DOM 선택하기
</a>
</li>
<li class="chapter " data-level="1.2.11" data-path="../basic/11-render-array.html">
<a href="https://react.vlpt.us/basic/11-render-array.html">
11. 배열 렌더링하기
</a>
</li>
<li class="chapter expanded" data-level="1.2.12" data-path="../basic/12-variable-with-useRef.html">
<a href="https://react.vlpt.us/basic/12-variable-with-useRef.html">
12. useRef 로 useRef 로 컴포넌트 안의 변수 만들기
</a>
</li>
<li class="chapter expanded" data-level="1.2.13" data-path="../basic/13-array-insert.html">
<a href="https://react.vlpt.us/basic/13-array-insert.html">
13. 배열에 항목 추가하기
</a>
</li>
<li class="chapter " data-level="1.2.14" data-path="../basic/14-array-remove.html">
<a href="https://react.vlpt.us/basic/14-array-remove.html">
14. 배열에 항목 제거하기
</a>
</li>
<li class="chapter " data-level="1.2.15" data-path="../basic/15-array-modify.html">
<a href="https://react.vlpt.us/basic/15-array-modify.html">
15. 배열에 항목 수정하기
</a>
</li>
<li class="chapter " data-level="1.2.16" data-path="../basic/16-useEffect.html">
<a href="https://react.vlpt.us/basic/16-useEffect.html">
16. useEffect를 사용하여 마운트/언마운트/업데이트시 할 작업 설정하기
</a>
</li>
<li class="chapter " data-level="1.2.17" data-path="../basic/17-useMemo.html">
<a href="https://react.vlpt.us/basic/17-useMemo.html">
17. useMemo 를 사용하여 연산한 값 재사용하기
</a>
</li>
<li class="chapter " data-level="1.2.18" data-path="../basic/18-useCallback.html">
<a href="https://react.vlpt.us/basic/18-useCallback.html">
18. useCallback 를 사용하여 함수 재사용하기
</a>
</li>
<li class="chapter " data-level="1.2.19" data-path="../basic/19-React.memo.html">
<a href="https://react.vlpt.us/basic/19-React.memo.html">
19. React.memo 를 사용한 컴포넌트 리렌더링 방지
</a>
</li>
<li class="chapter " data-level="1.2.20" data-path="../basic/20-useReducer.html">
<a href="https://react.vlpt.us/basic/20-useReducer.html">
20. useReducer 를 사용하여 상태 업데이트 로직 분리하기
</a>
</li>
<li class="chapter expanded" data-level="1.2.21" data-path="../basic/21-custom-hook.html">
<a href="https://react.vlpt.us/basic/21-custom-hook.html">
21. 커스텀 Hooks 만들기
</a>
</li>
<li class="chapter expanded" data-level="1.2.22" data-path="../basic/22-context-dispatch.html">
<a href="https://react.vlpt.us/basic/22-context-dispatch.html">
22. Context API 를 사용한 전역 값 관리
</a>
</li>
<li class="chapter expanded" data-level="1.2.23" data-path="../basic/23-immer.html">
<a href="https://react.vlpt.us/basic/23-immer.html">
23. Immer 를 사용한 더 쉬운 불변성 관리
</a>
</li>
<li class="chapter expanded" data-level="1.2.24" data-path="../basic/24-class-component.html">
<a href="https://react.vlpt.us/basic/24-class-component.html">
24. 클래스형 컴포넌트
</a>
</li>
<li class="chapter expanded" data-level="1.2.25" data-path="../basic/25-lifecycle.html">
<a href="https://react.vlpt.us/basic/25-lifecycle.html">
25. LifeCycle Method
</a>
</li>
<li class="chapter expanded" data-level="1.2.26" data-path="../basic/26-componentDidCatch-and-sentry.html">
<a href="https://react.vlpt.us/basic/26-componentDidCatch-and-sentry.html">
26. componentDidCatch 로 에러 잡아내기 / Sentry 연동
</a>
</li>
<li class="chapter expanded" data-level="1.2.27" data-path="../basic/27-useful-tools.html">
<a href="https://react.vlpt.us/basic/27-useful-tools.html">
27. 리액트 개발 할 때 사용하면 편리한 도구들 - Prettier, ESLint, Snippet
</a>
</li>
<li class="chapter expanded" data-level="1.2.28" data-path="../basic/CONCLUSION.html">
<a href="https://react.vlpt.us/basic/CONCLUSION.html">
리액트 입문 마무리
</a>
</li>
 </ul>
</li>
<li class="chapter expanded" data-level="1.3" data-path="../styling/">
<a href="https://react.vlpt.us/styling/">
2장. 리액트 컴포넌트 스타일링하기
<i class="exc-trigger fa"></i></a>
<ul class="articles">
<li class="chapter expanded" data-level="1.3.1" data-path="../styling/01-sass.html">
<a href="https://react.vlpt.us/styling/01-sass.html">
1. Sass
</a>
</li>
<li class="chapter expanded" data-level="1.3.2" data-path="../styling/02-css-module.html">
<a href="https://react.vlpt.us/styling/02-css-module.html">
2. CSS Module
</a>
</li>
<li class="chapter expanded" data-level="1.3.3" data-path="../styling/03-styled-components.html">
<a href="https://react.vlpt.us/styling/03-styled-components.html">
3. styled-components
</a>
</li>
<li class="chapter expanded" data-level="1.3.4" data-path="../styling/CONCLUSION.html">
<a href="https://react.vlpt.us/styling/CONCLUSION.html">
정리
</a>
</li>
</ul>
</li>
<li class="chapter expanded" data-level="1.4" data-path="../mashup-todolist/">
<a href="https://react.vlpt.us/mashup-todolist/">
3장. 멋진 투두리스트 만들기
<i class="exc-trigger fa"></i></a>
<ul class="articles">
<li class="chapter expanded" data-level="1.4.1" data-path="../mashup-todolist/01-create-components.html">
<a href="https://react.vlpt.us/mashup-todolist/01-create-components.html">
1. 컴포넌트 만들기
</a>
</li>
<li class="chapter expanded" data-level="1.4.2" data-path="../mashup-todolist/02-manage-state.html">
<a href="https://react.vlpt.us/mashup-todolist/02-manage-state.html">
2. Context API를 활용한 상태 관리
</a>
</li>
<li class="chapter expanded" data-level="1.4.3" data-path="../mashup-todolist/03-implement.html">
<a href="https://react.vlpt.us/mashup-todolist/03-implement.html">
3. 기능 구현하기
</a>
</li>
</ul>
</li>
<li class="chapter expanded" data-level="1.5" data-path="../integrate-api/">
<a href="https://react.vlpt.us/integrate-api/">
4장. API 연동하기
<i class="exc-trigger fa"></i></a>
<ul class="articles">
<li class="chapter expanded" data-level="1.5.1" data-path="../integrate-api/01-basic.html">
<a href="https://react.vlpt.us/integrate-api/01-basic.html">
1. API 연동의 기본
</a>
</li>
<li class="chapter expanded" data-level="1.5.2" data-path="../integrate-api/02-useReducer.html">
<a href="https://react.vlpt.us/integrate-api/02-useReducer.html">
2. useReducer 로 요청 상태 관리하기
</a>
</li>
<li class="chapter expanded" data-level="1.5.3" data-path="../integrate-api/03-useAsync.html">
<a href="https://react.vlpt.us/integrate-api/03-useAsync.html">
3. useAsync 커스텀 Hook 만들어서 사용하기
</a>

</li>
<li class="chapter expanded" data-level="1.5.4" data-path="../integrate-api/04-react-async.html">
<a href="https://react.vlpt.us/integrate-api/04-react-async.html">
4. react-async 로 요청 상태 관리하기
</a>
</li>
<li class="chapter expanded" data-level="1.5.5" data-path="../integrate-api/05-using-with-context.html">
<a href="https://react.vlpt.us/integrate-api/05-using-with-context.html">
5. Context 와 함께 사용하기
</a>
</li>
<li class="chapter expanded" data-level="1.5.6" data-path="../integrate-api/CONCLUSION.html">
<a href="https://react.vlpt.us/integrate-api/CONCLUSION.html">
정리
</a>
</li>
</ul>
</li>
<li class="chapter expanded" data-level="1.6" data-path="../react-router/">
<a href="https://react.vlpt.us/react-router/">
5장. 리액트 라우터
<i class="exc-trigger fa"></i></a>
<ul class="articles">
<li class="chapter expanded" data-level="1.6.1" data-path="../react-router/01-concepts.html">
<a href="https://react.vlpt.us/react-router/01-concepts.html">
1. 프로젝트 준비 및 기본적인 사용법
</a>
</li>
<li class="chapter expanded" data-level="1.6.2" data-path="../react-router/02-params-and-query.html">
<a href="https://react.vlpt.us/react-router/02-params-and-query.html">
2. 파라미터와 쿼리
</a>
</li>
<li class="chapter expanded" data-level="1.6.3" data-path="../react-router/03-subroutes.html">
<a href="https://react.vlpt.us/react-router/03-subroutes.html">
3. 서브라우트
</a>
</li>
<li class="chapter expanded" data-level="1.6.4" data-path="../react-router/04-extra.html">
<a href="https://react.vlpt.us/react-router/04-extra.html">
4. 리액트 라우터 부가기능
</a>
</li>
<li class="chapter expanded" data-level="1.6.5" data-path="../react-router/05-use-router-hook.html">
<a href="https://react.vlpt.us/react-router/05-use-router-hook.html">
5. useReactRouter Hook 사용하기
</a>
</li>
</ul>
</li>
<li class="chapter expanded" data-level="1.7" data-path="../redux/">
<a href="https://react.vlpt.us/redux/">
6장. 리덕스
<i class="exc-trigger fa"></i></a>
<ul class="articles">
<li class="chapter expanded" data-level="1.7.1" data-path="../redux/01-keywords.html">
<a href="https://react.vlpt.us/redux/01-keywords.html">
1. 리덕스에서 사용되는 키워드 숙지하기
</a>
</li>
<li class="chapter expanded" data-level="1.7.2" data-path="../redux/02-rules.html">
<a href="https://react.vlpt.us/redux/02-rules.html">
2. 리덕스의 3가지 규칙
</a>

</li>
<li class="chapter expanded" data-level="1.7.3" data-path="../redux/03-prepare.html">
<a href="https://react.vlpt.us/redux/03-prepare.html">
3. 리덕스 사용 할 준비하기
</a>
</li>
<li class="chapter expanded" data-level="1.7.4" data-path="../redux/04-make-modules.html">
<a href="https://react.vlpt.us/redux/04-make-modules.html">
4. 리덕스 모듈 만들기
</a>
</li>
<li class="chapter expanded" data-level="1.7.5" data-path="../redux/05-counter.html">
<a href="https://react.vlpt.us/redux/05-counter.html">
5. 카운터 구현하기
</a>
</li>
<li class="chapter expanded" data-level="1.7.6" data-path="../redux/06-redux-devtools.html">
<a href="https://react.vlpt.us/redux/06-redux-devtools.html">
6. 리덕스 개발자도구 적용하기
</a>
</li>
<li class="chapter expanded" data-level="1.7.7" data-path="../redux/07-implement-todos.html">
<a href="https://react.vlpt.us/redux/07-implement-todos.html">
7. 할 일 목록 구현하기
</a>
</li>
<li class="chapter expanded" data-level="1.7.8" data-path="../redux/08-optimize-useSelector.html">
<a href="https://react.vlpt.us/redux/08-optimize-useSelector.html">
8. useSelector 최적화
</a>
</li>
<li class="chapter expanded" data-level="1.7.9" data-path="../redux/09-connect.html">
<a href="https://react.vlpt.us/redux/09-connect.html">
9. connect 함수
</a>
</li>
<li class="chapter expanded" data-level="1.7.10" data-path="../redux/CONCLUSION.html">
<a href="https://react.vlpt.us/redux/CONCLUSION.html">
정리
</a>
</li>
</ul>
</li>
<li class="chapter expanded" data-level="1.8" data-path="../redux-middleware/">
<a href="https://react.vlpt.us/redux-middleware/">
7장. 리덕스 미들웨어
<i class="exc-trigger fa"></i></a>
<ul class="articles">
<li class="chapter expanded" data-level="1.8.1" data-path="../redux-middleware/01-prepare.html">
<a href="https://react.vlpt.us/redux-middleware/01-prepare.html">
1. 리덕스 프로젝트 준비하기
</a>
</li>
<li class="chapter expanded" data-level="1.8.2" data-path="../redux-middleware/02-make-middleware.html">
<a href="https://react.vlpt.us/redux-middleware/02-make-middleware.html">
2. 미들웨어 만들어보고 이해하기
</a>
</li>
<li class="chapter expanded" data-level="1.8.3" data-path="../redux-middleware/03-logger-and-devtools.html">
<a href="https://react.vlpt.us/redux-middleware/03-logger-and-devtools.html">
3. redux-logger 사용 및 미들웨어와 DevTools 함께 사용하기
</a>
 </li>
<li class="chapter expanded" data-level="1.8.4" data-path="../redux-middleware/04-redux-thunk.html">
<a href="https://react.vlpt.us/redux-middleware/04-redux-thunk.html">
4. redux-thunk
</a>
</li>
<li class="chapter expanded" data-level="1.8.5" data-path="../redux-middleware/05-redux-thunk-with-promise.html">
<a href="https://react.vlpt.us/redux-middleware/05-redux-thunk-with-promise.html">
5. redux-thunk로 프로미스 다루기
</a>
</li>
<li class="chapter expanded" data-level="1.8.6" data-path="../redux-middleware/06-fix-reloading.html">
<a href="https://react.vlpt.us/redux-middleware/06-fix-reloading.html">
6. API 재로딩 문제 해결하기
</a>
</li>
<li class="chapter expanded" data-level="1.8.7" data-path="../redux-middleware/07-router-with-thunk.html">
<a href="https://react.vlpt.us/redux-middleware/07-router-with-thunk.html">
7. thunk에서 라우터 연동하기
</a>
</li>
<li class="chapter expanded" data-level="1.8.8" data-path="../redux-middleware/08-json-server.html">
<a href="https://react.vlpt.us/redux-middleware/08-json-server.html">
8. json-server
</a>
</li>
<li class="chapter expanded" data-level="1.8.9" data-path="../redux-middleware/09-cors-and-proxy.html">
<a href="https://react.vlpt.us/redux-middleware/09-cors-and-proxy.html">
9. CORS 와 Webpack DevServer Proxy
</a>
</li>
<li class="chapter expanded" data-level="1.8.10" data-path="../redux-middleware/10-redux-saga.html">
<a href="https://react.vlpt.us/redux-middleware/10-redux-saga.html">
10. redux-saga
</a>
</li>
<li class="chapter expanded" data-level="1.8.11" data-path="../redux-middleware/11-redux-saga-with-promise.html">
<a href="https://react.vlpt.us/redux-middleware/11-redux-saga-with-promise.html">
11. redux-saga 로 프로미스 다루기
</a>
</li>
<li class="chapter expanded" data-level="1.8.12" data-path="../redux-middleware/12-redux-saga-with-router.html">
<a href="https://react.vlpt.us/redux-middleware/12-redux-saga-with-router.html">
12. saga에서 라우터 연동하기
</a>
</li>
<li class="chapter expanded" data-level="1.8.13" data-path="../redux-middleware/CONCLUSION.html">
<a href="https://react.vlpt.us/redux-middleware/CONCLUSION.html">
정리
</a>
</li>
</ul>
</li>
<li class="chapter expanded" data-level="1.9" data-path="./">
<a href="https://react.vlpt.us/using-typescript/">
8장. 리액트 프로젝트에서 타입스크립트 사용하기
<i class="exc-trigger fa"></i></a>
<ul class="articles">
<li class="chapter expanded" data-level="1.9.1" data-path="01-practice.html">
<a href="https://react.vlpt.us/using-typescript/01-practice.html">

1. 타입스크립트 연습
</a>
</li>
<li class="chapter expanded" data-level="1.9.2" data-path="02-ts-react-basic.html">
<a href="https://react.vlpt.us/using-typescript/02-ts-react-basic.html">
2. 리액트 컴포넌트 타입스크립트로 작성하기
</a>
</li>
<li class="chapter expanded" data-level="1.9.3" data-path="03-ts-manage-state.html">
<a href="https://react.vlpt.us/using-typescript/03-ts-manage-state.html">
3. 타입스크립트로 리액트 상태 관리하기
</a>
</li>
<li class="chapter expanded" data-level="1.9.4" data-path="04-ts-context.html">
<a href="https://react.vlpt.us/using-typescript/04-ts-context.html">
4. TypeScript 와 Context API 활용하기
</a>
</li>
<li class="chapter expanded" data-level="1.9.5" data-path="05-ts-redux.html">
<a href="https://react.vlpt.us/using-typescript/05-ts-redux.html">
5. TypeScript 에서 리덕스 프로처럼 사용하기
</a>
</li>
<li class="chapter active expanded" data-level="1.9.6" data-path="06-ts-redux-middleware.html">
<a href="https://react.vlpt.us/using-typescript/06-ts-redux-middleware.html">
6.타입스크립트에서 리덕스 미들웨어 사용하기 (redux-thunk, redux-saga)
</a>
</li>
</ul>
</li>
<li class="divider"></li>
<li>
<a href="https://www.gitbook.com/" target="blank" class="gitbook-link" style="display: none;">
Published with GitBook
</a>
</li>
</ul>
</nav>
</div>
<div class="book-body">
<div class="body-inner">
<div class="book-header" role="navigation">

<a class="btn pull-left js-toolbar-action" aria-label="" href="https://react.vlpt.us/using-typescript/06-ts-redux-middleware.html#"><i class="fa fa-align-justify"></i></a><a class="btn pull-right js-toolbar-action" aria-label="GitHub" href="https://react.vlpt.us/using-typescript/06-ts-redux-middleware.html#"><i class="fa fa-github"></i></a><a class="btn pull-left js-toolbar-action" aria-label="" href="https://react.vlpt.us/using-typescript/06-ts-redux-middleware.html#"><i class="fa fa-edit"></i> 수정 요청하기</a><div class="dropdown pull-right js-toolbar-action"><a class="btn toggle-dropdown" aria-label="Share" href="https://react.vlpt.us/using-typescript/06-ts-redux-middleware.html#"><i class="fa fa-share-alt"></i></a><div class="dropdown-menu dropdown-left"><div class="dropdown-caret"><span class="caret-outer"></span><span class="caret-inner"></span></div><div class="buttons"><button class="button size-5 ">Facebook</button><button class="button size-5 ">Google+</button><button class="button size-5 ">Twitter</button><button class="button size-5 ">Weibo</button><button class="button size-5 ">Instapaper</button></div></div></div><a class="btn pull-right js-toolbar-action" aria-label="" href="https://react.vlpt.us/using-typescript/06-ts-redux-middleware.html#"><i class="fa fa-facebook"></i></a><a class="btn pull-right js-toolbar-action" aria-label="" href="https://react.vlpt.us/using-typescript/06-ts-redux-middleware.html#"><i class="fa fa-twitter"></i></a><div class="dropdown pull-left font-settings js-toolbar-action"><a class="btn toggle-dropdown" aria-label="Font Settings" href="https://react.vlpt.us/using-typescript/06-ts-redux-middleware.html#"><i class="fa fa-font"></i></a><div class="dropdown-menu dropdown-right"><div class="dropdown-caret"><span class="caret-outer"></span><span class="caret-inner"></span></div><div class="buttons"><button class="button size-2 font-reduce">A</button><button class="button size-2 font-enlarge">A</button></div><div class="buttons"><button class="button size-2 ">Serif</button><button class="button size-2 ">Sans</button></div><div class="buttons"><button class="button size-3 ">White</button><button class="button size-3 ">Sepia</button><button class="button size-3 ">Night</button></div></div></div><h1>
<i class="fa fa-circle-o-notch fa-spin"></i>
<a href="https://react.vlpt.us/">6.타입스크립트에서 리덕스 미들웨어 사용하기 (redux-thunk, redux-saga)</a>
</h1>
</div>
<div class="page-wrapper" tabindex="-1" role="main">
<div class="page-inner">
<div id="book-search-results">
<div class="search-noresults">
<section class="normal markdown-section">
<h1 id="6-타입스크립트에서-리덕스-미들웨어-사용하기-redux-thunk-redux-saga">6. 타입스크립트에서 리덕스 미들웨어 사용하기 (redux-thunk, redux-saga)</h1>
<p>이번 튜토리얼에서는 redux-thunk 또는 redux-saga 미들웨어를 타입스크립트 환경에서 사용 할 때에는 어떻게 사용하는지 알아보도록 하겠습니다. 만약에 redux-thunk 및 redux-saga를 다루는 방법을 잘 모르신다면 <a href="https://react.vlpt.us/redux-middleware/" target="_blank">리덕스 미들웨어</a> 튜토리얼을 먼저 읽어주세요.</p>
<p>리덕스 미들웨어를 사용하기 위하여 편의상 <a href="https://react.vlpt.us/using-typescript/05-ts-redux.html">이전 튜토리얼</a>에서 사용하던 프로젝트를 재사용하겠습니다. 만약 이전 튜토리얼을 진행하지 않으셨다면 이전 튜토리얼을 참고하여 리덕스를 적용한 프로젝트를 새로 만드시거나, 다음 명령어를 사용하여 프로젝트를 준비해주세요.</p>
<pre><code class="lang-bash">$ git <span class="hljs-built_in">clone</span> https://github.com/velopert/ts-react-redux-tutorial.git --branch refactor/counter2
</code></pre>
<h2 id="redux-thunk-적용하기">redux-thunk 적용하기</h2>
<p>먼저, redux-thunk 를 타입스크립트와 함께 사용하는 방법을 배워봅시다. 해당 라이브러리를 설치해주세요.</p>
<pre><code class="lang-bash">$ yarn add redux-thunk
</code></pre>
<p>redux-thunk는 공식적으로 타입스크립트 지원이 되므로 @types/redux-thunk 를 따로 설치하실 필요 없습니다.</p>
<p>그리고 우리가 API 요청을 실제로 해볼 것이기 때문에 axios 를 설치해주세요.</p>
<pre><code class="lang-bash">$ yarn add axios
</code></pre>
<p>axios 또한 타입스크립트 지원이 공식적으로 되므로 @types/axios 를 설치하실 필요가 없습니다.</p>
<p>설치를 다 하셨으면 스토어에 미들웨어를 적용해보겠습니다.</p>
<h4 id="srcindexjs">src/index.js</h4>
<pre><code class="lang-javascript"><span class="hljs-keyword">import</span> React <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;
<span class="hljs-keyword">import</span> ReactDOM <span class="hljs-keyword">from</span> <span class="hljs-string">'react-dom'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-string">'./index.css'</span>;
<span class="hljs-keyword">import</span> App <span class="hljs-keyword">from</span> <span class="hljs-string">'./App'</span>;
<span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> serviceWorker <span class="hljs-keyword">from</span> <span class="hljs-string">'./serviceWorker'</span>;
<span class="hljs-keyword">import</span> { Provider } <span class="hljs-keyword">from</span> <span class="hljs-string">'react-redux'</span>;
<span class="hljs-keyword">import</span> { createStore, applyMiddleware } <span class="hljs-keyword">from</span> <span class="hljs-string">'redux'</span>;
<span class="hljs-keyword">import</span> Thunk <span class="hljs-keyword">from</span> <span class="hljs-string">'redux-thunk'</span>;
<span class="hljs-keyword">import</span> rootReducer <span class="hljs-keyword">from</span> <span class="hljs-string">'./modules'</span>;

<span class="hljs-keyword">const</span> store = createStore(rootReducer, applyMiddleware(Thunk));

ReactDOM.render(
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Provider</span> <span class="hljs-attr">store</span>=<span class="hljs-string">{store}</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">App</span> /&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">Provider</span>&gt;</span>,
  document.getElementById('root')
);

// If you want your app to work offline and load faster, you can change
// unregister() to register() below. Note this comes with some pitfalls.
// Learn more about service workers: https://bit.ly/CRA-PWA
serviceWorker.unregister();
</span></code></pre>
<h3 id="github-사용자-정보-가져오기">GitHub 사용자 정보 가져오기</h3>
<p>우리는 GitHub의 사용자 정보를 가져오는 기능을 구현해보도록 하겠습니다. GitHub의 사용자 정보를 가져올 떄에는 다음 API 를 사용합니다.</p>
<pre><code>GET https://api.github.com/users/:username
</code></pre><p><code>:username</code> 이 있는 자리에 여러분이 조회하고자 하는 사용자의 유저네임 (예: velopert) 를 넣으시면 됩니다. 다음과 같이 말이죠.</p>
<pre><code>GET https://api.github.com/users/velopert
</code></pre><p>참고로 결과물은 다음과 같습니다.</p>
<pre><code class="lang-javascript">{
    <span class="hljs-string">"login"</span>: <span class="hljs-string">"velopert"</span>,
    <span class="hljs-string">"id"</span>: <span class="hljs-number">17202261</span>,
    <span class="hljs-string">"node_id"</span>: <span class="hljs-string">"MDQ6VXNlcjE3MjAyMjYx"</span>,
    <span class="hljs-string">"avatar_url"</span>: <span class="hljs-string">"https://avatars0.githubusercontent.com/u/17202261?v=4"</span>,
    <span class="hljs-string">"gravatar_id"</span>: <span class="hljs-string">""</span>,
    <span class="hljs-string">"url"</span>: <span class="hljs-string">"https://api.github.com/users/velopert"</span>,
    <span class="hljs-string">"html_url"</span>: <span class="hljs-string">"https://github.com/velopert"</span>,
    <span class="hljs-string">"followers_url"</span>: <span class="hljs-string">"https://api.github.com/users/velopert/followers"</span>,
    <span class="hljs-string">"following_url"</span>: <span class="hljs-string">"https://api.github.com/users/velopert/following{/other_user}"</span>,
    <span class="hljs-string">"gists_url"</span>: <span class="hljs-string">"https://api.github.com/users/velopert/gists{/gist_id}"</span>,
    <span class="hljs-string">"starred_url"</span>: <span class="hljs-string">"https://api.github.com/users/velopert/starred{/owner}{/repo}"</span>,
    <span class="hljs-string">"subscriptions_url"</span>: <span class="hljs-string">"https://api.github.com/users/velopert/subscriptions"</span>,
    <span class="hljs-string">"organizations_url"</span>: <span class="hljs-string">"https://api.github.com/users/velopert/orgs"</span>,
    <span class="hljs-string">"repos_url"</span>: <span class="hljs-string">"https://api.github.com/users/velopert/repos"</span>,
    <span class="hljs-string">"events_url"</span>: <span class="hljs-string">"https://api.github.com/users/velopert/events{/privacy}"</span>,
    <span class="hljs-string">"received_events_url"</span>: <span class="hljs-string">"https://api.github.com/users/velopert/received_events"</span>,
    <span class="hljs-string">"type"</span>: <span class="hljs-string">"User"</span>,
    <span class="hljs-string">"site_admin"</span>: <span class="hljs-literal">false</span>,
    <span class="hljs-string">"name"</span>: <span class="hljs-string">"Minjun Kim"</span>,
    <span class="hljs-string">"company"</span>: <span class="hljs-string">"@laftel-team "</span>,
    <span class="hljs-string">"blog"</span>: <span class="hljs-string">"https://velopert.com/"</span>,
    <span class="hljs-string">"location"</span>: <span class="hljs-literal">null</span>,
    <span class="hljs-string">"email"</span>: <span class="hljs-literal">null</span>,
    <span class="hljs-string">"hireable"</span>: <span class="hljs-literal">null</span>,
    <span class="hljs-string">"bio"</span>: <span class="hljs-string">"개발은 언제나 즐겁고 재밌어야 한다는 생각을 갖고 있는 개발자이며, 가르치는것을 굉장히 좋아하는 교육자이기도 합니다."</span>,
    <span class="hljs-string">"public_repos"</span>: <span class="hljs-number">64</span>,
    <span class="hljs-string">"public_gists"</span>: <span class="hljs-number">31</span>,
    <span class="hljs-string">"followers"</span>: <span class="hljs-number">1016</span>,
    <span class="hljs-string">"following"</span>: <span class="hljs-number">16</span>,
    <span class="hljs-string">"created_at"</span>: <span class="hljs-string">"2016-02-12T16:43:22Z"</span>,
    <span class="hljs-string">"updated_at"</span>: <span class="hljs-string">"2019-09-04T16:23:39Z"</span>
}
</code></pre>
<p>우리를 응답된 데이터에 대한 타입도 준비를 해주어야 하는데요, 이렇게 많은 종류의 데이터를 하나하나 직접 하기엔 번거로울수도 있습니다. 그럴 땐, <a href="https://app.quicktype.io/?l=ts" target="_blank">Quicktype</a>라는 서비스를 사용하여 JSON 을 바로 타입스크립트 인터페이스로 변환 할 수 있습니다.</p>
<p>참고로, <a href="https://marketplace.visualstudio.com/items?itemName=quicktype.quicktype" target="_blank">VS Code Extension</a>도 있습니다.</p>
<p><img src="./6.타입스크립트에서 리덕스 미들웨어 사용하기 (redux-thunk, redux-saga) · GitBook_files/YLnloXu.png" alt=""></p>
<p>물론, 때에 따라 변환된 것을 그대로 복사해서 사용하면 안되고, 일부 값들은 수작업으로 조금 변경을 해줘야 할 수도 있습니다. 예를 들어 제가 복사한 JSON 안에 있는 <code>email</code> 값은 현재 <code>null</code>이지만, <a href="https://github.com/settings/tokens" target="_blank">GitHub API 토큰</a>을 사용하여 인증된 계정을 통해 API 를 요청하게 되면 <code>email</code> 쪽에 문자열이 올 수도 있습니다. 여러분이 만약 실무에서 타입스크립트를 사용하고, 백엔드와 연동을 하게 될 때에도 비슷한 상황이 있을 수 있겠지요? 때문에 변환된 인터페이스를 그대로 사용하면 안되고, 실제 사용 케이스에 맞춰서 조금씩 변경해야 할 필요가 있을 수도 있다는 점 잘 기억해두세요.</p>
<p>지금은 그냥 그대로 사용을 하도록 하겠습니다.</p>
<p>src 디렉터리에 api 디렉터리를 만들고, github.ts 라는 파일을 생성 후 다음과 같이 코드를 작성해주세요.</p>
<h4 id="srcapigithubts">src/api/github.ts</h4>
<pre><code class="lang-javascript"><span class="hljs-keyword">import</span> axios <span class="hljs-keyword">from</span> <span class="hljs-string">'axios'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getUserProfile</span>(<span class="hljs-params">username: string</span>) </span>{
  <span class="hljs-comment">// Generic 을 통해 응답 데이터의 타입을 설정 할 수 있습니다.</span>
  <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> axios.get&lt;GithubProfile&gt;(
    <span class="hljs-string">`https://api.github.com/users/<span class="hljs-subst">${username}</span>`</span>
  );
  <span class="hljs-keyword">return</span> response.data; <span class="hljs-comment">// 데이터 값을 바로 반환하도록 처리합니다.</span>
}

<span class="hljs-keyword">export</span> interface GithubProfile {
  login: string;
  id: number;
  node_id: string;
  avatar_url: string;
  gravatar_id: string;
  url: string;
  html_url: string;
  followers_url: string;
  following_url: string;
  gists_url: string;
  starred_url: string;
  subscriptions_url: string;
  organizations_url: string;
  repos_url: string;
  events_url: string;
  received_events_url: string;
  type: string;
  site_admin: boolean;
  name: string;
  company: string;
  blog: string;
  location: <span class="hljs-literal">null</span>;
  email: <span class="hljs-literal">null</span>;
  hireable: <span class="hljs-literal">null</span>;
  bio: string;
  public_repos: number;
  public_gists: number;
  followers: number;
  following: number;
  created_at: <span class="hljs-built_in">Date</span>;
  updated_at: <span class="hljs-built_in">Date</span>;
}
</code></pre>
<h3 id="github-리덕스-모듈-만들기">github 리덕스 모듈 만들기</h3>
<p>이제 github 이라는 리덕스 모듈을 준비해봅시다. modules 디렉터리에 github 디렉터리를 만들고, 그 안에 액션부터 정의를 해봅시다.</p>
<h4 id="액션-정의하기">액션 정의하기</h4>
<h4 id="srcmodulesgithubactionsts">src/modules/github/actions.ts</h4>
<pre><code class="lang-javascript"><span class="hljs-keyword">import</span> { createStandardAction } <span class="hljs-keyword">from</span> <span class="hljs-string">'typesafe-actions'</span>;
<span class="hljs-keyword">import</span> { GithubProfile } <span class="hljs-keyword">from</span> <span class="hljs-string">'../../api/github'</span>;
<span class="hljs-keyword">import</span> { AxiosError } <span class="hljs-keyword">from</span> <span class="hljs-string">'axios'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> GET_USER_PROFILE = <span class="hljs-string">'github/GET_USER_PROFILE'</span>;
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> GET_USER_PROFILE_SUCCESS = <span class="hljs-string">'github/GET_USER_PROFILE_SUCCESS'</span>;
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> GET_USER_PROFILE_ERROR = <span class="hljs-string">'github/GET_USER_PROFILE_ERROR'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> getUserProfile = createStandardAction(GET_USER_PROFILE)();
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> getUserProfileSuccess = createStandardAction(GET_USER_PROFILE_SUCCESS)&lt;GithubProfile&gt;();
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> getUserProfileError = createStandardAction(GET_USER_PROFILE_ERROR)&lt;AxiosError&gt;();
</code></pre>
<p>여기서 <code>GET_USER_PROFILE</code> 의 용도는 요청이 시작됐을 때 디스패치되는 액션이고, 나머지 두개의 액션들은 성공 / 실패 했을때 디스패치되는 액션들입니다.</p>
<p>typesafe-actions 에는 <a href="https://www.npmjs.com/package/typesafe-actions#createasyncaction" target="_blank">createAsyncAction</a> 라는 유틸함수가 있는데요, 이를 사용하면 위 코드를 다음과 같이 리팩토링 할 수 있답니다.</p>
<h4 id="srcmodulesgithubactionsts">src/modules/github/actions.ts</h4>
<pre><code class="lang-javascript"><span class="hljs-keyword">import</span> { createAsyncAction } <span class="hljs-keyword">from</span> <span class="hljs-string">'typesafe-actions'</span>;
<span class="hljs-keyword">import</span> { GithubProfile } <span class="hljs-keyword">from</span> <span class="hljs-string">'../../api/github'</span>;
<span class="hljs-keyword">import</span> { AxiosError } <span class="hljs-keyword">from</span> <span class="hljs-string">'axios'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> GET_USER_PROFILE = <span class="hljs-string">'github/GET_USER_PROFILE'</span>;
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> GET_USER_PROFILE_SUCCESS = <span class="hljs-string">'github/GET_USER_PROFILE_SUCCESS'</span>;
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> GET_USER_PROFILE_ERROR = <span class="hljs-string">'github/GET_USER_PROFILE_ERROR'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> getUserProfileAsync = createAsyncAction(
  GET_USER_PROFILE,
  GET_USER_PROFILE_SUCCESS,
  GET_USER_PROFILE_ERROR
)&lt;<span class="hljs-literal">undefined</span>, GithubProfile, AxiosError&gt;();
</code></pre>
<p>이 유틸함수를 꼭 사용 할 필요는 없지만, 만약에 이 형태의 코드가 맘에 드신다면 잘 활용하시면 반복되는 코드를 덜 입력할 수 있어서 편합니다.</p>
<h4 id="thunk-함수-작성하기">thunk 함수 작성하기</h4>
<p>액션을 모두 작성하셨다면, 이제 thunk 함수를 만들어줍시다.</p>
<p>modules/github 디렉터리에 thunks.ts 파일을 만드시고 다음 코드를 작성하세요.</p>
<h4 id="modulesgithubthunksts">modules/github/thunks.ts</h4>
<pre><code class="lang-javascript"><span class="hljs-keyword">import</span> { ThunkAction } <span class="hljs-keyword">from</span> <span class="hljs-string">'redux-thunk'</span>;
<span class="hljs-keyword">import</span> { RootState } <span class="hljs-keyword">from</span> <span class="hljs-string">'..'</span>;
<span class="hljs-keyword">import</span> { GithubAction } <span class="hljs-keyword">from</span> <span class="hljs-string">'./types'</span>;
<span class="hljs-keyword">import</span> { getUserProfile } <span class="hljs-keyword">from</span> <span class="hljs-string">'../../api/github'</span>;
<span class="hljs-keyword">import</span> { getUserProfileAsync } <span class="hljs-keyword">from</span> <span class="hljs-string">'./actions'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getUserProfileThunk</span>(<span class="hljs-params">username: string</span>): <span class="hljs-title">ThunkAction</span>&lt;<span class="hljs-title">void</span>, <span class="hljs-title">RootState</span>, <span class="hljs-title">null</span>, <span class="hljs-title">GithubAction</span>&gt; </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">async</span> dispatch =&gt; {
    <span class="hljs-keyword">const</span> { request, success, failure } = getUserProfileAsync;
    dispatch(request());
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">const</span> userProfile = <span class="hljs-keyword">await</span> getUserProfile(username);
      dispatch(success(userProfile));
    } <span class="hljs-keyword">catch</span> (e) {
      dispatch(failure(e));
    }
  };
}
</code></pre>
<p><code>ThunkAction</code> 의 Generics 로는 다음 값들을 순서대로 넣어주어야 합니다. <code>&lt;TReturnType, TState, TExtraThunkArg, TBasicAction&gt;</code></p>
<ol>
<li><strong>TReturnType</strong>: thunk 함수에서 반환하는 값의 타입을 설정합니다.</li>
<li><strong>TState</strong>: 스토어의 상태에 대한 타입을 설정합니다.</li>
<li><strong>TExtraThunkArg</strong>: redux-thunk 미들웨어의 <a href="https://github.com/reduxjs/redux-thunk#injecting-a-custom-argument" target="_blank">Extra Argument</a>의 타입을 설정합니다.</li>
<li><strong>TBasicAction</strong>: dispatch 할 수 있는 액션들의 타입을 설정합니다.</li>
</ol>
<p>TReturnType 의 경우 아무것도 반환하지 않는다면 <code>void</code> 라고 넣으시면 됩니다. 현재 상황에서는 thunk 함수에서 <code>async</code> 를 사용하고 있으니 <code>Promise&lt;void&gt;</code>가 더 정확합니다. 하지만 그냥 <code>void</code> 라고 입력해도 문제가 되지는 않습니다.</p>
<h4 id="리듀서-작성하기">리듀서 작성하기</h4>
<p>이제 리듀서를 작성해줄건데요, 리듀서를 작성하기전에 우선 github 리덕스 모듈에서 관리 할 상태에 대한 타입을 선언해주세요.</p>
<h4 id="srcmodulesgithubtypests">src/modules/github/types.ts</h4>
<pre><code class="lang-javascript"><span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> actions <span class="hljs-keyword">from</span> <span class="hljs-string">'./actions'</span>;
<span class="hljs-keyword">import</span> { ActionType } <span class="hljs-keyword">from</span> <span class="hljs-string">'typesafe-actions'</span>;
<span class="hljs-keyword">import</span> { GithubProfile } <span class="hljs-keyword">from</span> <span class="hljs-string">'../../api/github'</span>;

<span class="hljs-keyword">export</span> type GithubAction = ActionType&lt;<span class="hljs-keyword">typeof</span> actions&gt;;

<span class="hljs-keyword">export</span> type GithubState = {
  userProfile: {
    loading: boolean;
    error: <span class="hljs-built_in">Error</span> | <span class="hljs-literal">null</span>;
    data: GithubProfile | <span class="hljs-literal">null</span>;
  };
};
</code></pre>
<p>그 다음 리듀서를 작성하세요. 리듀서는 reducer.ts 파일을 만들어서 작성하시면 됩니다.</p>
<h4 id="srcmodulesgithubreducerts">src/modules/github/reducer.ts</h4>
<pre><code class="lang-javascript"><span class="hljs-keyword">import</span> { createReducer } <span class="hljs-keyword">from</span> <span class="hljs-string">'typesafe-actions'</span>;
<span class="hljs-keyword">import</span> { GithubState, GithubAction } <span class="hljs-keyword">from</span> <span class="hljs-string">'./types'</span>;
<span class="hljs-keyword">import</span> { GET_USER_PROFILE, GET_USER_PROFILE_SUCCESS, GET_USER_PROFILE_ERROR } <span class="hljs-keyword">from</span> <span class="hljs-string">'./actions'</span>;

<span class="hljs-keyword">const</span> initialState: GithubState = {
  userProfile: {
    loading: <span class="hljs-literal">false</span>,
    error: <span class="hljs-literal">null</span>,
    data: <span class="hljs-literal">null</span>
  }
};

<span class="hljs-keyword">const</span> github = createReducer&lt;GithubState, GithubAction&gt;(initialState, {
  [GET_USER_PROFILE]: state =&gt; ({
    ...state,
    userProfile: {
      loading: <span class="hljs-literal">true</span>,
      error: <span class="hljs-literal">null</span>,
      data: <span class="hljs-literal">null</span>
    }
  }),
  [GET_USER_PROFILE_SUCCESS]: (state, action) =&gt; ({
    ...state,
    userProfile: {
      loading: <span class="hljs-literal">false</span>,
      error: <span class="hljs-literal">null</span>,
      data: action.payload
    }
  }),
  [GET_USER_PROFILE_ERROR]: (state, action) =&gt; ({
    ...state,
    userProfile: {
      loading: <span class="hljs-literal">false</span>,
      error: action.payload,
      data: <span class="hljs-literal">null</span>
    }
  })
});

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> github;
</code></pre>
<p>리듀서 작성도 모두 끝났습니다. 앞으로 API 한번 요청 할 때마다 이런 작업을 해주어야 하는데요, 그러면 비슷한 코드가 엄청나게 많이 늘어나겠지요? 걱정 마세요! 나중에 리팩토링해줄겁니다.</p>
<p>리듀서 작성이 끝나셨으면 github 디렉터리에 index.ts 를 만들어서 우리가 만든 리듀서, 액션, 타입, thunk 함수를 불러와서 내보내주세요.</p>
<h4 id="srcmodulesgithubindexts">src/modules/github/index.ts</h4>
<pre><code class="lang-javascript"><span class="hljs-keyword">export</span> { <span class="hljs-keyword">default</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'./reducer'</span>;
<span class="hljs-keyword">export</span> * <span class="hljs-keyword">from</span> <span class="hljs-string">'./actions'</span>;
<span class="hljs-keyword">export</span> * <span class="hljs-keyword">from</span> <span class="hljs-string">'./types'</span>;
<span class="hljs-keyword">export</span> * <span class="hljs-keyword">from</span> <span class="hljs-string">'./thunks'</span>;
</code></pre>
<p>그 다음에는 github 리듀서를 루트 리듀서에 등록해주세요.</p>
<h4 id="srcmodulesindexts">src/modules/index.ts</h4>
<pre><code class="lang-javascript"><span class="hljs-keyword">import</span> { combineReducers } <span class="hljs-keyword">from</span> <span class="hljs-string">'redux'</span>;
<span class="hljs-keyword">import</span> counter <span class="hljs-keyword">from</span> <span class="hljs-string">'./counter'</span>;
<span class="hljs-keyword">import</span> todos <span class="hljs-keyword">from</span> <span class="hljs-string">'./todos'</span>;
<span class="hljs-keyword">import</span> github <span class="hljs-keyword">from</span> <span class="hljs-string">'./github'</span>;

<span class="hljs-keyword">const</span> rootReducer = combineReducers({
  counter,
  todos,
  github
});

<span class="hljs-comment">// 루트 리듀서를 내보내주세요.</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> rootReducer;

<span class="hljs-comment">// 루트 리듀서의 반환값를 유추해줍니다</span>
<span class="hljs-comment">// 추후 이 타입을 컨테이너 컴포넌트에서 불러와서 사용해야 하므로 내보내줍니다.</span>
<span class="hljs-keyword">export</span> type RootState = ReturnType&lt;<span class="hljs-keyword">typeof</span> rootReducer&gt;;
</code></pre>
<h3 id="github-사용자-정보를-불러오기-위한-프리젠테이셔널-컴포넌트-준비">GitHub 사용자 정보를 불러오기 위한 프리젠테이셔널 컴포넌트 준비</h3>
<p>GitHub 사용자 정보를 불러오기 위한 프리젠테이셔널 컴포넌트를 준비해봅시다!</p>
<p>첫번째 컴포넌트 GithubUsernameForm 에서는 사용자 계정명을 입력 할 수 있는 인풋과, 클릭하면 정보를 조회해주는 버튼을 만들어주도록 하겠습니다. 스타일 없이 만들면 심심하니까 스타일 코드도 조금 작성하겠습니다.</p>
<h4 id="srccomponentsgithubusernameformtsx">src/components/GithubUsernameForm.tsx</h4>
<pre><code class="lang-javascript"><span class="hljs-keyword">import</span> React, { FormEvent, useState, ChangeEvent } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-string">'./GithubUsernameForm.css'</span>;

type GithubUsernameFormProps = {
  onSubmitUsername: (username: string) =&gt; <span class="hljs-keyword">void</span>;
};

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">GithubUsernameForm</span>(<span class="hljs-params">{ onSubmitUsername }: GithubUsernameFormProps</span>) </span>{
  <span class="hljs-keyword">const</span> [input, setInput] = useState(<span class="hljs-string">''</span>);

  <span class="hljs-keyword">const</span> onSubmit = (e: FormEvent&lt;HTMLFormElement&gt;) =&gt; {
    e.preventDefault();
    onSubmitUsername(input);
  };

  <span class="hljs-keyword">const</span> onChange = (e: ChangeEvent&lt;HTMLInputElement&gt;) =&gt; {
    setInput(e.target.value);
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"GithubUsernameForm"</span> <span class="hljs-attr">onSubmit</span>=<span class="hljs-string">{onSubmit}</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">onChange</span>=<span class="hljs-string">{onChange}</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{input}</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"Github 계정명을 입력하세요."</span> /&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"submit"</span>&gt;</span>조회<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span>
  );
}

export default GithubUsernameForm;
</span></code></pre>
<h4 id="srccomponentsgithubusernameformcss">src/components/GithubUsernameForm.css</h4>
<p>스타일 파일도 작성해줍시다!</p>
<pre><code class="lang-css"><span class="hljs-selector-class">.GithubUsernameForm</span> {
  <span class="hljs-attribute">width</span>: <span class="hljs-number">400px</span>;
  <span class="hljs-attribute">display</span>: flex;
  <span class="hljs-attribute">align-items</span>: center;
  <span class="hljs-attribute">height</span>: <span class="hljs-number">32px</span>;
  <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span> auto;
  <span class="hljs-attribute">margin-top</span>: <span class="hljs-number">16px</span>;
  <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">48px</span>;
}

<span class="hljs-selector-class">.GithubUsernameForm</span> <span class="hljs-selector-tag">input</span> {
  <span class="hljs-attribute">flex</span>: <span class="hljs-number">1</span>;
  <span class="hljs-attribute">border</span>: none;
  <span class="hljs-attribute">outline</span>: none;
  <span class="hljs-attribute">border-bottom</span>: <span class="hljs-number">1px</span> solid black;
  <span class="hljs-attribute">font-size</span>: <span class="hljs-number">21px</span>;
  <span class="hljs-attribute">height</span>: <span class="hljs-number">100%</span>;
  <span class="hljs-attribute">margin-right</span>: <span class="hljs-number">1rem</span>;
}

<span class="hljs-selector-class">.GithubUsernameForm</span> <span class="hljs-selector-tag">button</span> {
  <span class="hljs-attribute">background</span>: black;
  <span class="hljs-attribute">color</span>: white;
  <span class="hljs-attribute">cursor</span>: pointer;
  <span class="hljs-attribute">outline</span>: none;
  <span class="hljs-attribute">border</span>: none;
  <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">4px</span>;
  <span class="hljs-attribute">font-size</span>: <span class="hljs-number">16px</span>;
  <span class="hljs-attribute">padding-left</span>: <span class="hljs-number">16px</span>;
  <span class="hljs-attribute">padding-right</span>: <span class="hljs-number">16px</span>;
  <span class="hljs-attribute">height</span>: <span class="hljs-number">100%</span>;
  <span class="hljs-attribute">font-weight</span>: bold;
}

<span class="hljs-selector-class">.GithubUsernameForm</span> <span class="hljs-selector-tag">button</span><span class="hljs-selector-pseudo">:hover</span> {
  <span class="hljs-attribute">background</span>: <span class="hljs-number">#495057</span>;
}
</code></pre>
<p>그 다음에는, 사용자 계정에 대한 정보를 보여줄 GithubProfileInfo 라는 컴포넌트를 만들어보겠습니다.</p>
<h4 id="srccomponentsgithubprofileinfotsx">src/components/GithubProfileInfo.tsx</h4>
<pre><code class="lang-javascript"><span class="hljs-keyword">import</span> React <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-string">'./GithubProfileInfo.css'</span>;

type GithubProfileInfoProps = {
  name: string;
  thumbnail: string;
  bio: string;
  blog: string;
};

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">GithubProfileInfo</span>(<span class="hljs-params">{ name, thumbnail, bio, blog }: GithubProfileInfoProps</span>) </span>{
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"GithubProfileInfo"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"profile-head"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">{thumbnail}</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">"user thumbnail"</span> /&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"name"</span>&gt;</span>{name}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>{bio}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>{blog !== '' &amp;&amp; <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">{blog}</span>&gt;</span>블로그<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  );
}

export default GithubProfileInfo;
</span></code></pre>
<p>이 컴포넌트에서는 이름, 프로필 사진, 자기소개, 그리고 블로그 링크를 보여줍니다. 블로그 링크의 경우엔 없는 경우도 있으니 있을 때에만 렌더링하도록 설정해주었습니다.</p>
<p>스타일도 작성해주세요</p>
<h4 id="srccomponentsgithubprofileinfocss">src/components/GithubProfileInfo.css</h4>
<pre><code class="lang-javascript">.GithubProfileInfo {
  width: <span class="hljs-number">400</span>px;
  margin: <span class="hljs-number">0</span> auto;
}

.GithubProfileInfo .profile-head {
  display: flex;
  align-items: center;
}

.GithubProfileInfo .profile-head img {
  display: block;
  width: <span class="hljs-number">64</span>px;
  height: <span class="hljs-number">64</span>px;
  border-radius: <span class="hljs-number">32</span>px;
  margin-right: <span class="hljs-number">1</span>rem;
}

.GithubProfileInfo .profile-head .name {
  font-weight: bold;
}
</code></pre>
<h3 id="github-사용자-정보를-불러오기-위한-컨테이너-만들기">Github 사용자 정보를 불러오기 위한 컨테이너 만들기</h3>
<p>자, 이번에는 Github 사용자를 불러오기 위한 컨테이너를 만들어봅시다. 컨테이너 컴포넌트의 이름은 GithubProfileLoader 라고 하겠습니다.</p>
<h4 id="srccontainersgithubprofileloadertsx">src/containers/GithubProfileLoader.tsx</h4>
<pre><code class="lang-javascript"><span class="hljs-keyword">import</span> React <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;
<span class="hljs-keyword">import</span> { useDispatch, useSelector } <span class="hljs-keyword">from</span> <span class="hljs-string">'react-redux'</span>;
<span class="hljs-keyword">import</span> { RootState } <span class="hljs-keyword">from</span> <span class="hljs-string">'../modules'</span>;
<span class="hljs-keyword">import</span> GithubUsernameForm <span class="hljs-keyword">from</span> <span class="hljs-string">'../components/GithubUsernameForm'</span>;
<span class="hljs-keyword">import</span> GithubProfileInfo <span class="hljs-keyword">from</span> <span class="hljs-string">'../components/GithubProfileInfo'</span>;
<span class="hljs-keyword">import</span> { getUserProfileThunk } <span class="hljs-keyword">from</span> <span class="hljs-string">'../modules/github'</span>;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">GithubProfileLoader</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> { data, loading, error } = useSelector((state: RootState) =&gt; state.github.userProfile);
  <span class="hljs-keyword">const</span> dispatch = useDispatch();

  <span class="hljs-keyword">const</span> onSubmitUsername = (username: string) =&gt; {
    dispatch(getUserProfileThunk(username));
  };

  <span class="hljs-keyword">return</span> (
    &lt;&gt;
      &lt;GithubUsernameForm onSubmitUsername={onSubmitUsername} /&gt;
      {loading &amp;&amp; &lt;p style={{ textAlign: 'center' }}&gt;로딩중..&lt;/p&gt;}
      {error &amp;&amp; &lt;p style={{ textAlign: 'center' }}&gt;에러 발생!&lt;/p&gt;}
      {data &amp;&amp; &lt;GithubProfileInfo bio={data.bio} blog={data.blog} name={data.name} thumbnail={data.avatar_url} /&gt;}
    &lt;/&gt;
  );
}

export default GithubProfileLoader;
</code></pre>
<p>이제 App 컴포넌트에서 방금 만든 컨테이너를 렌더링하고 잘 작동하는지 확인해보세요. </p>
<h4 id="srcapptsx">src/App.tsx</h4>
<pre><code class="lang-javascript"><span class="hljs-keyword">import</span> React <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;

<span class="hljs-keyword">import</span> GithubProfileLoader <span class="hljs-keyword">from</span> <span class="hljs-string">'./containers/GithubProfileLoader'</span>;

<span class="hljs-keyword">const</span> App: React.FC = () =&gt; {
  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">GithubProfileLoader</span> /&gt;</span>;
};

export default App;
</span></code></pre>
<p>인풋에는 여러분의 Github 계정명을 적어보시거나, 만약 Github 계정이 없으시다면 제 계정명을 입력해보세요 (velopert)</p>
<p><img src="./6.타입스크립트에서 리덕스 미들웨어 사용하기 (redux-thunk, redux-saga) · GitBook_files/SwVYnTC.png" alt=""></p>
<p>(<a href="https://github.com/velopert/ts-react-redux-tutorial/tree/middleware/thunk" target="_blank">코드</a>)</p>
<h2 id="thunk-함수와-리듀서-리팩토링하기">thunk 함수와 리듀서 리팩토링하기</h2>
<p>앞으로 API를 연동 하실 때 마다 우리가 이번에 했던 작업들을 반복적으로 하시게 될텐데요, 반복되는 코드들을 최대한 재사용 할 수 있도록 리팩토링을 하는 방법을 알아보도록 하겠습니다.</p>
<h3 id="promise-기반-thunk-를-만들어주는-createasyncthunk-함수-만들기">Promise 기반 thunk 를 만들어주는 createAsyncThunk 함수 만들기</h3>
<p>먼저 해야 할 것은 thunk 함수를 한줄로 만들어주는 <code>createAsyncThunk</code> 함수를 만드는 것 입니다. 이 함수는 <code>createAsyncAction</code> 로 만든 액션 생성함수와 Promise 를 만들어주는 함수를 파라미터로 가져와서 thunk 를 만들어줍니다.</p>
<p>src 디렉터리에 lib 디렉터리를 만들고, 다음 파일을 작성해주세요.</p>
<h4 id="srclibcreateasyncthunkts">src/lib/createAsyncThunk.ts</h4>
<pre><code class="lang-javascript"><span class="hljs-keyword">import</span> { Dispatch } <span class="hljs-keyword">from</span> <span class="hljs-string">'redux'</span>;
<span class="hljs-keyword">import</span> { AsyncActionCreator } <span class="hljs-keyword">from</span> <span class="hljs-string">'typesafe-actions'</span>;

type AnyAsyncActionCreator = AsyncActionCreator&lt;any, any, any&gt;;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createAsyncThunk</span>&lt;<span class="hljs-title">A</span> <span class="hljs-title">extends</span> <span class="hljs-title">AnyAsyncActionCreator</span>, <span class="hljs-title">F</span> <span class="hljs-title">extends</span> (<span class="hljs-params">...params: any[]</span>) =&gt; <span class="hljs-title">Promise</span>&lt;<span class="hljs-title">any</span>&gt;&gt;(<span class="hljs-params">
  asyncActionCreator: A,
  promiseCreator: F
</span>) </span>{
  type Params = Parameters&lt;F&gt;;
  <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">thunk</span>(<span class="hljs-params">...params: Params</span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">async</span> (dispatch: Dispatch) =&gt; {
      <span class="hljs-keyword">const</span> { request, success, failure } = asyncActionCreator;
      dispatch(request(<span class="hljs-literal">undefined</span>)); <span class="hljs-comment">// 파라미터를 비우면 타입 에러가 나기 때문에 undefined 전달</span>
      <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> promiseCreator(...params);
        dispatch(success(result));
      } <span class="hljs-keyword">catch</span> (e) {
        dispatch(failure(e));
      }
    };
  };
}
</code></pre>
<p>위 코드의 <code>F extends (...params: any[]) =&gt; Promise&lt;any&gt;</code> 는, F 를 Generics 로 받아오는데 해당 타입은 프로미스를 리턴하는 함수형태만 받아올 수 있도록 설정해줍니다.</p>
<p>그리고, <code>type Params = Parameters&lt;F&gt;;</code> 는 함수의 파라미터들의 타입을 추론해줍니다. 이를 통하여 F 함수의 파라미터와 thunk 함수의 파라미터가 동일하게끔 설정을 해줄 수 있습니다.</p>
<p>이렇게 함수를 작성해주고 나면 우리가 기존에 작성했던 thunk 함수를 다음과 같이 한줄로 구현 할 수 있게됩니다.</p>
<h4 id="srcmodulesgithubthunksts">src/modules/github/thunks.ts</h4>
<pre><code class="lang-javascript"><span class="hljs-keyword">import</span> { getUserProfile } <span class="hljs-keyword">from</span> <span class="hljs-string">'../../api/github'</span>;
<span class="hljs-keyword">import</span> { getUserProfileAsync } <span class="hljs-keyword">from</span> <span class="hljs-string">'./actions'</span>;
<span class="hljs-keyword">import</span> createAsyncThunk <span class="hljs-keyword">from</span> <span class="hljs-string">'../../lib/createAsyncThunk'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> getUserProfileThunk = createAsyncThunk(getUserProfileAsync, getUserProfile);
</code></pre>
<p>정말 간결하지요? API 연동을 할 때마다 12줄 가량의 코드를 더 이상 작성 할 필요가 없게 됐습니다! 물론 모든 API 연동 작업에 대하여 이 유틸 함수를 사용 할 수는 없을 것입니다. 가끔씩은 까다로운 로직을 가지고 있는 thunk 함수의 경우엔 당연히 직접 작성해야 될 수도 있겠죠. 하지만 이렇게 단순히 데이터만 바로 조회하는 형태의 코드라면 <code>createAsyncThunk</code> 함수를 사용하여 구현하면 편할 것 입니다.</p>
<h3 id="리듀서-리팩토링하기">리듀서 리팩토링하기</h3>
<p>이번에는 리듀서를 리팩토링 할 차례입니다. 우리는 현재 API 요청에 관련된 상태의 경우 <code>{ loading, error, data }</code> 형태로 관리를 하고 있는데요, 이 객체를 조금 더 쉽게 만들 수 있는 유틸 함수들을 만들어주겠습니다.</p>
<p>lib 디렉터리에 reducerUtils.ts 파일을 생성하고 다음 코드들을 작성해주세요.</p>
<h4 id="srclibreducerutilsts">src/lib/reducerUtils.ts</h4>
<pre><code class="lang-javascript"><span class="hljs-keyword">export</span> type AsyncState&lt;T, E = any&gt; = {
  data: T | <span class="hljs-literal">null</span>;
  loading: boolean;
  error: E | <span class="hljs-literal">null</span>;
};

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> asyncState = {
  <span class="hljs-comment">// 다음 코드는 화살표 함수에 Generic 을 설정 한 것입니다.</span>
  initial: &lt;T, E = any&gt;(initialData?: T): AsyncState&lt;T, E&gt; =&gt; ({
    loading: false,
    data: initialData || null,
    error: null
  }),
  load: &lt;T, E = any&gt;(data?: T): AsyncState&lt;T, E&gt; =&gt; ({
    loading: true,
    data: data || null,
    error: null
  }),
  success: &lt;T, E = any&gt;(data: T): AsyncState&lt;T, E&gt; =&gt; ({
    loading: false,
    data,
    error: null
  }),
  error: &lt;T, E&gt;(error: E): AsyncState&lt;T, E&gt; =&gt; ({
    loading: false,
    data: null,
    error: error
  })
};
</code></pre>
<p>유틸을 모두 작성하셨으면, GithubState 의 타입을 다음과 같이 수정해주세요.</p>
<h4 id="srcmodulesgithubtypests">src/modules/github/types.ts</h4>
<pre><code class="lang-javascript"><span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> actions <span class="hljs-keyword">from</span> <span class="hljs-string">'./actions'</span>;
<span class="hljs-keyword">import</span> { ActionType } <span class="hljs-keyword">from</span> <span class="hljs-string">'typesafe-actions'</span>;
<span class="hljs-keyword">import</span> { GithubProfile } <span class="hljs-keyword">from</span> <span class="hljs-string">'../../api/github'</span>;
<span class="hljs-keyword">import</span> { AsyncState } <span class="hljs-keyword">from</span> <span class="hljs-string">'../../lib/reducerUtils'</span>;
<span class="hljs-keyword">export</span> type GithubAction = ActionType&lt;<span class="hljs-keyword">typeof</span> actions&gt;;

<span class="hljs-keyword">export</span> type GithubState = {
  userProfile: AsyncState&lt;GithubProfile, <span class="hljs-built_in">Error</span>&gt;;
};
</code></pre>
<p><code>AsyncState</code> 를 사용해서 매번 <code>loading</code>, <code>data</code>, <code>error</code> 의 타입을 직접 입력해줄 필요 없이 한줄로 깔끔하게 작성 할 수 있게 됐습니다.</p>
<p>그 다음엔 리듀서를 다음과 같이 수정해주세요.</p>
<h4 id="srcmodulesgithubreducerts">src/modules/github/reducer.ts</h4>
<pre><code class="lang-javascript"><span class="hljs-keyword">import</span> { createReducer } <span class="hljs-keyword">from</span> <span class="hljs-string">'typesafe-actions'</span>;
<span class="hljs-keyword">import</span> { GithubState, GithubAction } <span class="hljs-keyword">from</span> <span class="hljs-string">'./types'</span>;
<span class="hljs-keyword">import</span> { GET_USER_PROFILE, GET_USER_PROFILE_SUCCESS, GET_USER_PROFILE_ERROR } <span class="hljs-keyword">from</span> <span class="hljs-string">'./actions'</span>;
<span class="hljs-keyword">import</span> { asyncState } <span class="hljs-keyword">from</span> <span class="hljs-string">'../../lib/reducerUtils'</span>;

<span class="hljs-keyword">const</span> initialState: GithubState = {
  userProfile: asyncState.initial()
};

<span class="hljs-keyword">const</span> github = createReducer&lt;GithubState, GithubAction&gt;(initialState, {
  [GET_USER_PROFILE]: state =&gt; ({
    ...state,
    userProfile: asyncState.load()
  }),
  [GET_USER_PROFILE_SUCCESS]: (state, action) =&gt; ({
    ...state,
    userProfile: asyncState.success(action.payload)
  }),
  [GET_USER_PROFILE_ERROR]: (state, action) =&gt; ({
    ...state,
    userProfile: asyncState.error(action.payload)
  })
});

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> github;
</code></pre>
<p>코드가 훨씬 더 깔끔해졌죠? 그런데 여기서 더 욕심을 내봅시다. <code>createReducer</code> 를 사용해서 리듀서를 만들 때 <code>handleAction</code> 을 사용해서 메서드 체이닝을 하는 방식으로 구현을 하면, 다음과 같이 여러 액션에 대하여 하나의 업데이트 함수를 설정해줄 수가 있습니다.</p>
<pre><code class="lang-javascript">  .handleAction([add, increment], (state, action) =&gt;
    state + (action.type === <span class="hljs-string">'ADD'</span> ? action.payload : <span class="hljs-number">1</span>)
  );
</code></pre>
<p>이러한 속성을 사용하여 우리가 만든 리듀서를 리팩토링 해보겠습니다. 먼저, createAsyncReducer 라는 함수를 reducerUtils.ts 에 다음과 같이 만들어보세요.</p>
<h4 id="srclibreducerutilsts">src/lib/reducerUtils.ts</h4>
<pre><code class="lang-javascript"><span class="hljs-keyword">import</span> { AnyAction } <span class="hljs-keyword">from</span> <span class="hljs-string">'redux'</span>;
<span class="hljs-keyword">import</span> { getType } <span class="hljs-keyword">from</span> <span class="hljs-string">'typesafe-actions'</span>;

<span class="hljs-keyword">export</span> type AsyncState&lt;T, E = any&gt; = {
  data: T | <span class="hljs-literal">null</span>;
  loading: boolean;
  error: E | <span class="hljs-literal">null</span>;
};

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> asyncState = {
  <span class="hljs-comment">// 다음 코드는 화살표 함수에 Generic 을 설정 한 것입니다.</span>
  initial: &lt;T, E = any&gt;(initialData?: T): AsyncState&lt;T, E&gt; =&gt; ({
    loading: false,
    data: initialData || null,
    error: null
  }),
  load: &lt;T, E = any&gt;(data?: T): AsyncState&lt;T, E&gt; =&gt; ({
    loading: true,
    data: data || null,
    error: null
  }),
  success: &lt;T, E = any&gt;(data: T): AsyncState&lt;T, E&gt; =&gt; ({
    loading: false,
    data,
    error: null
  }),
  error: &lt;T, E&gt;(error: E): AsyncState&lt;T, E&gt; =&gt; ({
    loading: false,
    data: null,
    error: error
  })
};

type AnyAsyncActionCreator = AsyncActionCreator&lt;any, any, any&gt;;
export function createAsyncReducer&lt;S, AC extends AnyAsyncActionCreator, K extends keyof S&gt;(
  asyncActionCreator: AC,
  key: K
) {
  return (state: S, action: AnyAction) =&gt; {
    // 각 액션 생성함수의 type 을 추출해줍니다.
    const [request, success, failure] = [
      asyncActionCreator.request,
      asyncActionCreator.success,
      asyncActionCreator.failure
    ].map(getType);
    switch (action.type) {
      case request:
        return {
          ...state,
          [key]: asyncState.load()
        };
      case success:
        return {
          ...state,
          [key]: asyncState.success(action.payload)
        };
      case failure:
        return {
          ...state,
          [key]: asyncState.error(action.payload)
        };
      default:
        return state;
    }
  };
}
</code></pre>
<p>여기서 사용한 <code>AnyAsyncActionCreator</code> 는 <code>createAsyncThunk</code> 에서 사용했던 타입과 동일한데요, 원하신다면 따로 types.ts 파일로 추출해내서 분리하셔도 좋습니다. </p>
<p><code>createAsyncReducer</code>를 모두 다 작성하셨으면, github 리듀서를 다음과 같이 리팩토링해보세요.</p>
<h4 id="srcmodulesgithubreducerts">src/modules/github/reducer.ts</h4>
<pre><code class="lang-javascript"><span class="hljs-keyword">import</span> { createReducer } <span class="hljs-keyword">from</span> <span class="hljs-string">'typesafe-actions'</span>;
<span class="hljs-keyword">import</span> { GithubState, GithubAction } <span class="hljs-keyword">from</span> <span class="hljs-string">'./types'</span>;
<span class="hljs-keyword">import</span> { getUserProfileAsync } <span class="hljs-keyword">from</span> <span class="hljs-string">'./actions'</span>;
<span class="hljs-keyword">import</span> { asyncState, createAsyncReducer } <span class="hljs-keyword">from</span> <span class="hljs-string">'../../lib/reducerUtils'</span>;

<span class="hljs-keyword">const</span> initialState: GithubState = {
  userProfile: asyncState.initial()
};

<span class="hljs-keyword">const</span> github = createReducer&lt;GithubState, GithubAction&gt;(initialState).handleAction(
  [getUserProfileAsync.request, getUserProfileAsync.success, getUserProfileAsync.failure],
  createAsyncReducer(getUserProfileAsync, <span class="hljs-string">'userProfile'</span>)
);

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> github;
</code></pre>
<p>코드가 완전 짧아졌지요? 이제 만약 앞으로 새로운 API 를 요청하게 된다면 리듀서에 코드 4줄만 추가해주면 된답니다.</p>
<p>여기서 더 나아가자면 <code>[getUserProfileAsync.request, getUserProfileAsync.success, getUserProfileAsync.failure]</code> 이 부분을 다음과 같이 <code>transformToArray</code>라는 함수를 만들어서 리팩토링 할 수도 있습니다.</p>
<p>다음 함수를 reducerUtils.ts 에 추가를 해주시구요</p>
<h4 id="srclibreducerutilsts">src/lib/reducerUtils.ts</h4>
<pre><code class="lang-javascript">(...)

<span class="hljs-keyword">export</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">transformToArray</span>&lt;<span class="hljs-title">AC</span> <span class="hljs-title">extends</span> <span class="hljs-title">AnyAsyncActionCreator</span>&gt;(<span class="hljs-params">asyncActionCreator: AC</span>) </span>{
  <span class="hljs-keyword">const</span> { request, success, failure } = asyncActionCreator;
  <span class="hljs-keyword">return</span> [request, success, failure];
}
</code></pre>
<p>github 리듀서에서 다음과 같이 <code>transformToArray</code> 를 사용하시면 됩니다.</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">import</span> { createReducer } <span class="hljs-keyword">from</span> <span class="hljs-string">'typesafe-actions'</span>;
<span class="hljs-keyword">import</span> { GithubState, GithubAction } <span class="hljs-keyword">from</span> <span class="hljs-string">'./types'</span>;
<span class="hljs-keyword">import</span> { getUserProfileAsync } <span class="hljs-keyword">from</span> <span class="hljs-string">'./actions'</span>;
<span class="hljs-keyword">import</span> { asyncState, createAsyncReducer, transformToArray } <span class="hljs-keyword">from</span> <span class="hljs-string">'../../lib/reducerUtils'</span>;

<span class="hljs-keyword">const</span> initialState: GithubState = {
  userProfile: asyncState.initial()
};

<span class="hljs-keyword">const</span> github = createReducer&lt;GithubState, GithubAction&gt;(initialState).handleAction(
  transformToArray(getUserProfileAsync),
  createAsyncReducer(getUserProfileAsync, <span class="hljs-string">'userProfile'</span>)
);

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> github;
</code></pre>
<p>하지만 꼭 이렇게 까지 하실 필요는 없답니다. 여러분의 취향에 맞게 여러분이 만족스러우실 정도로 리팩토링을 하시면 됩니다.</p>
<p>(<a href="https://github.com/velopert/ts-react-redux-tutorial/tree/middleware/thunk-refactor" target="_blank">코드</a>)</p>
<h2 id="redux-saga-사용하기">redux-saga 사용하기</h2>
<p>이번에는 프로젝트에서 비동기 작업을 관리하기 위하여 redux-thunk 대신에 redux-saga 를 사용하는 방법을 알아보겠습니다. 프로젝트에 redux-saga 를 설치해주세요. 우리가 기존에 redux-thunk로 구현했던것을 redux-saga로 똑같이 구현을 해볼건데요, 이를 진행하기 위해선 우선 <code>GET_USER_PROFILE</code> 액션에서 payload 로 사용자명을 받아오도록 설정해야됩니다. github/actions.ts 파일을 다음과 같이 수정해보세요.</p>
<h3 id="액션-수정하기">액션 수정하기</h3>
<h4 id="githubactionsts">github/actions.ts</h4>
<pre><code class="lang-javascript"><span class="hljs-keyword">import</span> { createAsyncAction } <span class="hljs-keyword">from</span> <span class="hljs-string">'typesafe-actions'</span>;
<span class="hljs-keyword">import</span> { GithubProfile } <span class="hljs-keyword">from</span> <span class="hljs-string">'../../api/github'</span>;
<span class="hljs-keyword">import</span> { AxiosError } <span class="hljs-keyword">from</span> <span class="hljs-string">'axios'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> GET_USER_PROFILE = <span class="hljs-string">'github/GET_USER_PROFILE'</span>;
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> GET_USER_PROFILE_SUCCESS = <span class="hljs-string">'github/GET_USER_PROFILE_SUCCESS'</span>;
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> GET_USER_PROFILE_ERROR = <span class="hljs-string">'github/GET_USER_PROFILE_ERROR'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> getUserProfileAsync = createAsyncAction(
  GET_USER_PROFILE,
  GET_USER_PROFILE_SUCCESS,
  GET_USER_PROFILE_ERROR
)&lt;string, GithubProfile, AxiosError&gt;();
</code></pre>
<p>기존에 <code>undefined</code> 였던 것을 <code>string</code> 으로 바꿔주시면 됩니다.</p>
<h3 id="saga-작성하기">saga 작성하기</h3>
<p>그 다음에는 비동기 액션을 처리 할 saga 를 작성해주겠습니다. github 디렉터리에 sagas.ts 라는 파일을 만들어서 다음과 같이 작성해보세요.</p>
<h4 id="srcmodulesgithubsagats">src/modules/github/saga.ts</h4>
<pre><code class="lang-javascript"><span class="hljs-keyword">import</span> { getUserProfileAsync, GET_USER_PROFILE } <span class="hljs-keyword">from</span> <span class="hljs-string">'./actions'</span>;
<span class="hljs-keyword">import</span> { getUserProfile, GithubProfile } <span class="hljs-keyword">from</span> <span class="hljs-string">'../../api/github'</span>;
<span class="hljs-keyword">import</span> { call, put, takeEvery } <span class="hljs-keyword">from</span> <span class="hljs-string">'redux-saga/effects'</span>;

<span class="hljs-function"><span class="hljs-keyword">function</span>* <span class="hljs-title">getUserProfileSaga</span>(<span class="hljs-params">action: ReturnType&lt;typeof getUserProfileAsync.request&gt;</span>) </span>{
  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">const</span> userProfile: GithubProfile = <span class="hljs-keyword">yield</span> call(getUserProfile, action.payload);
    <span class="hljs-keyword">yield</span> put(getUserProfileAsync.success(userProfile));
  } <span class="hljs-keyword">catch</span> (e) {
    <span class="hljs-keyword">yield</span> put(getUserProfileAsync.failure(e));
  }
}

<span class="hljs-keyword">export</span> <span class="hljs-function"><span class="hljs-keyword">function</span>* <span class="hljs-title">githubSaga</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">yield</span> takeEvery(GET_USER_PROFILE, getUserProfileSaga);
}
</code></pre>
<p>액션의 타입은 <code>ReturnType</code> 을 통해서 유추해내면 됩니다.</p>
<p>아직까지는 Generator 를 사용 할 때 <code>yield call</code> 를 통해서 프로미스를 만드는 특정 함수를 호출했을 경우 프로미스의 결과값에 대한 타입을 유추해내지 못합니다. 때문에 프로미스의 결과값은 force type 을 통해 타입을 지정해주어야 합니다.</p>
<p>최근 TypeScript 3.6 에서 <a href="https://devblogs.microsoft.com/typescript/announcing-typescript-3-6/" target="_blank">Generator 에 대한 타입 지원</a> 기능이 업데이트 되었으므로, 조만간 redux-saga 에서 완벽한 타입지원을 받는것이 가능해질것 같기도 하지만, 아직까지는 안됩니다. </p>
<p>saga를 다 작성하셨으면, github/index.ts 에서 불러와서 내보내주세요.</p>
<h4 id="srcmodulesgithubindexts">src/modules/github/index.ts</h4>
<pre><code class="lang-javascript"><span class="hljs-keyword">export</span> { <span class="hljs-keyword">default</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'./reducer'</span>;
<span class="hljs-keyword">export</span> * <span class="hljs-keyword">from</span> <span class="hljs-string">'./actions'</span>;
<span class="hljs-keyword">export</span> * <span class="hljs-keyword">from</span> <span class="hljs-string">'./types'</span>;
<span class="hljs-keyword">export</span> * <span class="hljs-keyword">from</span> <span class="hljs-string">'./thunks'</span>;
<span class="hljs-keyword">export</span> * <span class="hljs-keyword">from</span> <span class="hljs-string">'./sagas'</span>;
</code></pre>
<p>그 다음엔 루트 사가를 만들어주세요.</p>
<h4 id="srcmodulesindexts">src/modules/index.ts</h4>
<pre><code class="lang-javascript"><span class="hljs-keyword">import</span> { combineReducers } <span class="hljs-keyword">from</span> <span class="hljs-string">'redux'</span>;
<span class="hljs-keyword">import</span> counter <span class="hljs-keyword">from</span> <span class="hljs-string">'./counter'</span>;
<span class="hljs-keyword">import</span> todos <span class="hljs-keyword">from</span> <span class="hljs-string">'./todos'</span>;
<span class="hljs-keyword">import</span> github <span class="hljs-keyword">from</span> <span class="hljs-string">'./github/reducer'</span>;
<span class="hljs-keyword">import</span> { githubSaga } <span class="hljs-keyword">from</span> <span class="hljs-string">'./github'</span>;
<span class="hljs-keyword">import</span> { all } <span class="hljs-keyword">from</span> <span class="hljs-string">'redux-saga/effects'</span>;

<span class="hljs-keyword">const</span> rootReducer = combineReducers({
  counter,
  todos,
  github
});

<span class="hljs-comment">// 루트 리듀서를 내보내주세요.</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> rootReducer;

<span class="hljs-comment">// 루트 리듀서의 반환값를 유추해줍니다</span>
<span class="hljs-comment">// 추후 이 타입을 컨테이너 컴포넌트에서 불러와서 사용해야 하므로 내보내줍니다.</span>
<span class="hljs-keyword">export</span> type RootState = ReturnType&lt;<span class="hljs-keyword">typeof</span> rootReducer&gt;;

<span class="hljs-comment">// 루트 사가를 만들어서 내보내주세요.</span>
<span class="hljs-keyword">export</span> <span class="hljs-function"><span class="hljs-keyword">function</span>* <span class="hljs-title">rootSaga</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">yield</span> all([githubSaga()]);
}
</code></pre>
<h3 id="리덕스-스토어에-redux-saga-미들웨어-적용하기">리덕스 스토어에 redux-saga 미들웨어 적용하기</h3>
<p>이제 리덕스 스토어에 redux-saga 미들웨어를 적용해주세요. thunk 관련 코드는 이제 불필요하니 지워주시면 됩니다.</p>
<h4 id="indextsx">index.tsx</h4>
<pre><code class="lang-javascript"><span class="hljs-keyword">import</span> React <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;
<span class="hljs-keyword">import</span> ReactDOM <span class="hljs-keyword">from</span> <span class="hljs-string">'react-dom'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-string">'./index.css'</span>;
<span class="hljs-keyword">import</span> App <span class="hljs-keyword">from</span> <span class="hljs-string">'./App'</span>;
<span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> serviceWorker <span class="hljs-keyword">from</span> <span class="hljs-string">'./serviceWorker'</span>;
<span class="hljs-keyword">import</span> { Provider } <span class="hljs-keyword">from</span> <span class="hljs-string">'react-redux'</span>;
<span class="hljs-keyword">import</span> { createStore, applyMiddleware } <span class="hljs-keyword">from</span> <span class="hljs-string">'redux'</span>;
<span class="hljs-keyword">import</span> createSagaMiddleware <span class="hljs-keyword">from</span> <span class="hljs-string">'redux-saga'</span>;
<span class="hljs-keyword">import</span> rootReducer, { rootSaga } <span class="hljs-keyword">from</span> <span class="hljs-string">'./modules'</span>;

<span class="hljs-keyword">const</span> sagaMiddleware = createSagaMiddleware();

<span class="hljs-keyword">const</span> store = createStore(rootReducer, applyMiddleware(sagaMiddleware));

sagaMiddleware.run(rootSaga);

ReactDOM.render(
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Provider</span> <span class="hljs-attr">store</span>=<span class="hljs-string">{store}</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">App</span> /&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">Provider</span>&gt;</span>,
  document.getElementById('root')
);

// If you want your app to work offline and load faster, you can change
// unregister() to register() below. Note this comes with some pitfalls.
// Learn more about service workers: https://bit.ly/CRA-PWA
serviceWorker.unregister();
</span></code></pre>
<h3 id="githubprofileloader-컨테이너-컴포넌트-수정하기">GithubProfileLoader 컨테이너 컴포넌트 수정하기</h3>
<p>기존에는 GithubProfileLoader 컨테이너에서 thunk 함수를 디스패치 했었는데요, 이제 일반 request 액션을 디스패치하도록 수정을 해주세요.</p>
<h4 id="srccontainersgithubprofileloadertsx">src/containers/GithubProfileLoader.tsx</h4>
<pre><code class="lang-javascript"><span class="hljs-keyword">import</span> React <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;
<span class="hljs-keyword">import</span> { useDispatch, useSelector } <span class="hljs-keyword">from</span> <span class="hljs-string">'react-redux'</span>;
<span class="hljs-keyword">import</span> { RootState } <span class="hljs-keyword">from</span> <span class="hljs-string">'../modules'</span>;
<span class="hljs-keyword">import</span> GithubUsernameForm <span class="hljs-keyword">from</span> <span class="hljs-string">'../components/GithubUsernameForm'</span>;
<span class="hljs-keyword">import</span> GithubProfileInfo <span class="hljs-keyword">from</span> <span class="hljs-string">'../components/GithubProfileInfo'</span>;
<span class="hljs-keyword">import</span> { getUserProfileAsync } <span class="hljs-keyword">from</span> <span class="hljs-string">'../modules/github'</span>;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">GithubProfileLoader</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> { data, loading, error } = useSelector((state: RootState) =&gt; state.github.userProfile);
  <span class="hljs-keyword">const</span> dispatch = useDispatch();

  <span class="hljs-keyword">const</span> onSubmitUsername = (username: string) =&gt; {
    dispatch(getUserProfileAsync.request(username));
  };

  <span class="hljs-keyword">return</span> (
    &lt;&gt;
      &lt;GithubUsernameForm onSubmitUsername={onSubmitUsername} /&gt;
      {loading &amp;&amp; &lt;p style={{ textAlign: 'center' }}&gt;로딩중..&lt;/p&gt;}
      {error &amp;&amp; &lt;p style={{ textAlign: 'center' }}&gt;에러 발생!&lt;/p&gt;}
      {data &amp;&amp; &lt;GithubProfileInfo bio={data.bio} blog={data.blog} name={data.name} thumbnail={data.avatar_url} /&gt;}
    &lt;/&gt;
  );
}

export default GithubProfileLoader;
</code></pre>
<p>컨테이너를 수정하셨으면, 잘 작동하는지 한번 확인해주세요.</p>
<p>(<a href="https://github.com/velopert/ts-react-redux-tutorial/tree/middleware/saga/src" target="_blank">코드</a>)</p>
<h2 id="saga-리팩토링하기">saga 리팩토링하기</h2>
<p>이번에는 Promise를 기반으로 작동하는 saga 를 쉽게 만들 수 있게 해주는 유틸함수 <code>createAsyncSaga</code> 를 만들어서 코드를 리팩토링 해주도록 하겠습니다.</p>
<h4 id="srclibcreateasyncsagats"><code>src/lib/createAsyncSaga.ts</code></h4>
<pre><code class="lang-javascript"><span class="hljs-keyword">import</span> { call, put } <span class="hljs-keyword">from</span> <span class="hljs-string">'redux-saga/effects'</span>;
<span class="hljs-keyword">import</span> { AsyncActionCreator, PayloadAction } <span class="hljs-keyword">from</span> <span class="hljs-string">'typesafe-actions'</span>;

<span class="hljs-comment">/* 
  유틸함수의 재사용성을 높이기 위하여 함수의 파라미터는 언제나 하나의 값을 사용하도록 하고,
  action.payload 를 그대로 파라미터로 넣어주도록 설정합니다.
  만약에 여러가지 종류의 값을 파라미터로 넣어야 한다면 객체 형태로 만들어줘야 합니다.
*/</span>
type PromiseCreatorFunction&lt;P, T&gt; = ((payload: P) =&gt; <span class="hljs-built_in">Promise</span>&lt;T&gt;) | (() =&gt; <span class="hljs-built_in">Promise</span>&lt;T&gt;);

<span class="hljs-comment">// action 이 payload 를 갖고 있는지 확인합니다.</span>
<span class="hljs-comment">// __ is __ 문법은 Type guard 라고 부릅니다 https://www.typescriptlang.org/docs/handbook/advanced-types.html#type-guards-and-type-assertions</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isPayloadAction</span>&lt;<span class="hljs-title">P</span>&gt;(<span class="hljs-params">action: any</span>): <span class="hljs-title">action</span> <span class="hljs-title">is</span> <span class="hljs-title">PayloadAction</span>&lt;<span class="hljs-title">string</span>, <span class="hljs-title">P</span>&gt; </span>{
  <span class="hljs-keyword">return</span> action.payload !== <span class="hljs-literal">undefined</span>;
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createAsyncSaga</span>&lt;<span class="hljs-title">T1</span>, <span class="hljs-title">P1</span>, <span class="hljs-title">T2</span>, <span class="hljs-title">P2</span>, <span class="hljs-title">T3</span>, <span class="hljs-title">P3</span>&gt;(<span class="hljs-params">
  asyncActionCreator: AsyncActionCreator&lt;[T1, P1], [T2, P2], [T3, P3]&gt;,
  promiseCreator: PromiseCreatorFunction&lt;P1, P2&gt;
</span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span>* <span class="hljs-title">saga</span>(<span class="hljs-params">action: ReturnType&lt;typeof asyncActionCreator.request&gt;</span>) </span>{
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">const</span> result = isPayloadAction&lt;P1&gt;(action)
        ? <span class="hljs-keyword">yield</span> call(promiseCreator, action.payload)
        : <span class="hljs-keyword">yield</span> call(promiseCreator);
      <span class="hljs-keyword">yield</span> put(asyncActionCreator.success(result));
    } <span class="hljs-keyword">catch</span> (e) {
      <span class="hljs-keyword">yield</span> put(asyncActionCreator.failure(e));
    }
  };
}
</code></pre>
<p>이제 기존의 <code>getUserProfileSaga</code> 를 한 줄로 구현해봅시다!</p>
<h4 id="srcmodulesgithubsagasts">src/modules/github/sagas.ts</h4>
<pre><code class="lang-javascript"><span class="hljs-keyword">import</span> { getUserProfileAsync, GET_USER_PROFILE } <span class="hljs-keyword">from</span> <span class="hljs-string">'./actions'</span>;
<span class="hljs-keyword">import</span> { getUserProfile } <span class="hljs-keyword">from</span> <span class="hljs-string">'../../api/github'</span>;
<span class="hljs-keyword">import</span> { takeEvery } <span class="hljs-keyword">from</span> <span class="hljs-string">'redux-saga/effects'</span>;
<span class="hljs-keyword">import</span> createAsyncSaga <span class="hljs-keyword">from</span> <span class="hljs-string">'../../lib/createAsyncSaga'</span>;

<span class="hljs-keyword">const</span> getUserProfileSaga = createAsyncSaga(getUserProfileAsync, getUserProfile);

<span class="hljs-keyword">export</span> <span class="hljs-function"><span class="hljs-keyword">function</span>* <span class="hljs-title">githubSaga</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">yield</span> takeEvery(GET_USER_PROFILE, getUserProfileSaga);
}
</code></pre>
<p>코드가 정말 깔끔해졌죠? 이번에 만든 <code>createAsyncSaga</code> 의 경우엔 우리가 이전에 구현했던 <code>createAsyncThunk</code> 와 마찬가지로, 모든 상황에 사용 할 수는 없겠지만 단순히 복잡한 로직없이 API 요청만 해서 결과값을 받아와야 하는 경우에는 쉽게 saga 를 만들 수 있기 때문에 생산성에 큰 도움을 줄 수 있습니다.</p>
<p>코드를 저장하고 잘 작동하는지 확인해보세요.</p>
<h2 id="정리">정리</h2>
<p>이제 타입스크립트 + 리덕스 미들웨어 활용 방법부터, 리팩토링까지 모두 끝났습니다! 코드를 작성하게 될 때 무조건 이렇게 리팩토링을 할 필요는 없습니다. 하지만, 생산성에 도움이 된다면, 유지보수성에 도움을 준다면 충분히 할만한 가치가 있습니다.<script>
      function attachComments() {
        const el = document.querySelector('.markdown-section');
        if (!el) return;
        const script = document.createElement('script');
        script.src = 'https://utteranc.es/client.js';
        script.setAttribute('repo', 'velopert/react-tutorial');
        script.setAttribute('issue-term', 'title');
        script.setAttribute('crossorigin', 'anonymous');
        script.setAttribute('label', 'comments');
        el.appendChild(script);
      }
      setTimeout(attachComments, 100);
    </script></p>
<div class="utterances">
    <iframe class="utterances-frame" title="Comments" scrolling="no" src="./6.타입스크립트에서 리덕스 미들웨어 사용하기 (redux-thunk, redux-saga) · GitBook_files/utterances.html" loading="lazy"></iframe>
  </div></section>
</div>
<div class="search-results">
<div class="has-results">
<h1 class="search-results-title"><span class="search-results-count"></span> results matching "<span class="search-query"></span>"</h1>
<ul class="search-results-list"></ul>
</div>
<div class="no-results">
<h1 class="search-results-title">No results matching "<span class="search-query"></span>"</h1>
</div>
</div>
</div>
</div>
</div>
</div>
<a href="https://react.vlpt.us/using-typescript/05-ts-redux.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page: 5. TypeScript 에서 리덕스 프로처럼 사용하기">
<i class="fa fa-angle-left"></i>
</a>
</div>
<script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"6.타입스크립트에서 리덕스 미들웨어 사용하기 (redux-thunk, redux-saga)","level":"1.9.6","depth":2,"previous":{"title":"5. TypeScript 에서 리덕스 프로처럼 사용하기","level":"1.9.5","depth":2,"path":"using-typescript/05-ts-redux.md","ref":"./using-typescript/05-ts-redux.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":["collapsible-chapters","comment","hide-published-with","github","edit-link"],"pluginsConfig":{"github":{"url":"https://github.com/velopert/react-tutorial"},"search":{},"collapsible-chapters":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"hide-published-with":{},"fontsettings":{"theme":"white","family":"sans","size":2},"highlight":{},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"edit-link":{"label":"수정 요청하기","base":"https://github.com/velopert/react-tutorial/edit/master"},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false},"comment":{}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"using-typescript/06-ts-redux-middleware.md","mtime":"2019-09-08T16:21:54.621Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2019-09-25T13:34:28.960Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>
<script src="./6.타입스크립트에서 리덕스 미들웨어 사용하기 (redux-thunk, redux-saga) · GitBook_files/gitbook.js"></script>
<script src="./6.타입스크립트에서 리덕스 미들웨어 사용하기 (redux-thunk, redux-saga) · GitBook_files/theme.js"></script>
<script src="./6.타입스크립트에서 리덕스 미들웨어 사용하기 (redux-thunk, redux-saga) · GitBook_files/collapsible-chapters.js"></script>
<script src="./6.타입스크립트에서 리덕스 미들웨어 사용하기 (redux-thunk, redux-saga) · GitBook_files/plugin.js"></script>
<script src="./6.타입스크립트에서 리덕스 미들웨어 사용하기 (redux-thunk, redux-saga) · GitBook_files/plugin(1).js"></script>
<script src="./6.타입스크립트에서 리덕스 미들웨어 사용하기 (redux-thunk, redux-saga) · GitBook_files/plugin(2).js"></script>
<script src="./6.타입스크립트에서 리덕스 미들웨어 사용하기 (redux-thunk, redux-saga) · GitBook_files/search-engine.js"></script>
<script src="./6.타입스크립트에서 리덕스 미들웨어 사용하기 (redux-thunk, redux-saga) · GitBook_files/search.js"></script>
<script src="./6.타입스크립트에서 리덕스 미들웨어 사용하기 (redux-thunk, redux-saga) · GitBook_files/lunr.min.js"></script>
<script src="./6.타입스크립트에서 리덕스 미들웨어 사용하기 (redux-thunk, redux-saga) · GitBook_files/search-lunr.js"></script>
<script src="./6.타입스크립트에서 리덕스 미들웨어 사용하기 (redux-thunk, redux-saga) · GitBook_files/buttons.js"></script>
<script src="./6.타입스크립트에서 리덕스 미들웨어 사용하기 (redux-thunk, redux-saga) · GitBook_files/fontsettings.js"></script>


</body></html>